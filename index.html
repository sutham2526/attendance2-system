<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>ระบบเช็คชื่อเข้าเรียน</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Prompt', sans-serif; }
    .popup {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      display: none; justify-content: center; align-items: center;
    }
    .popup-content {
      background: white; padding: 20px; border-radius: 10px;
      width: 80%; max-height: 80%; overflow-y: auto;
    }
  </style>
</head>
<body class="bg-gradient-to-r from-pink-200 to-blue-200 min-h-screen">

  <!-- Header -->
  <header class="bg-pink-500 text-white text-center py-4 text-2xl font-bold shadow-md">
    ระบบเช็คชื่อ & จัดการข้อมูลนักเรียน
  </header>

  <!-- Content -->
  <div class="p-6">

    <!-- เพิ่มห้องเรียน -->
    <div class="bg-white shadow-lg rounded-xl p-6 mb-6">
      <h2 class="text-xl font-bold mb-3 text-pink-600">เพิ่มห้องเรียน</h2>
      <div class="flex space-x-2">
        <input id="className" type="text" placeholder="ชื่อห้องเรียน" class="border p-2 rounded w-full">
        <button onclick="addClassroom()" class="bg-pink-500 hover:bg-pink-600 text-white px-4 py-2 rounded">เพิ่มข้อมูล</button>
      </div>
    </div>

    <!-- รายการห้องเรียน -->
    <div class="bg-white shadow-lg rounded-xl p-6">
      <h2 class="text-xl font-bold mb-3 text-blue-600">รายการห้องเรียน</h2>
      <ul id="classList" class="space-y-2"></ul>
    </div>
  </div>

  <!-- Popup นำเข้าข้อมูล -->
  <div id="popup" class="popup">
    <div class="popup-content">
      <h3 class="text-lg font-bold mb-3">ตรวจสอบข้อมูลที่นำเข้า</h3>
      <div id="excelPreview" class="mb-4"></div>
      <div class="flex justify-end space-x-2">
        <button onclick="confirmImport()" class="bg-green-500 text-white px-4 py-2 rounded">ยืนยันข้อมูล</button>
        <button onclick="closePopup()" class="bg-red-500 text-white px-4 py-2 rounded">ยกเลิก</button>
      </div>
    </div>
  </div>

  <script>
    let classrooms = [];
    let importData = [];

    function addClassroom() {
      const name = document.getElementById('className').value.trim();
      if (!name) return alert("กรุณากรอกชื่อห้องเรียน");
      classrooms.push({name, students: []});
      renderClassrooms();
      document.getElementById('className').value = "";
    }

    function renderClassrooms() {
      const list = document.getElementById('classList');
      list.innerHTML = "";
      classrooms.forEach((c, i) => {
        const li = document.createElement('li');
        li.className = "border rounded p-3 flex justify-between items-center";
        li.innerHTML = `
          <div>
            <span class="font-bold">${c.name}</span> 
            <span class="text-gray-500">(${c.students.length} คน)</span>
          </div>
          <div class="space-x-2">
            <button onclick="manageStudents(${i})" class="bg-blue-500 text-white px-3 py-1 rounded">จัดการนักเรียน</button>
            <button onclick="editClass(${i})" class="bg-yellow-500 text-white px-3 py-1 rounded">แก้ไข</button>
            <button onclick="deleteClass(${i})" class="bg-red-500 text-white px-3 py-1 rounded">ลบ</button>
          </div>
        `;
        list.appendChild(li);
      });
    }

    function manageStudents(index) {
      const studentId = prompt("กรอกเลขประจำตัวนักเรียน");
      const studentName = prompt("กรอกชื่อ-สกุลนักเรียน");
      if (studentId && studentName) {
        classrooms[index].students.push({id: studentId, name: studentName});
        renderClassrooms();
      }
    }

    function editClass(index) {
      const newName = prompt("แก้ไขชื่อห้องเรียน", classrooms[index].name);
      if (newName) {
        classrooms[index].name = newName;
        renderClassrooms();
      }
    }

    function deleteClass(index) {
      if (confirm("ยืนยันการลบห้องเรียนนี้หรือไม่?")) {
        classrooms.splice(index, 1);
        renderClassrooms();
      }
    }

    // popup excel import
    function openPopup(data) {
      importData = data;
      document.getElementById('excelPreview').innerHTML = JSON.stringify(data, null, 2);
      document.getElementById('popup').style.display = "flex";
    }
    function closePopup() {
      document.getElementById('popup').style.display = "none";
    }
    function confirmImport() {
      alert("บันทึกข้อมูลเรียบร้อย!");
      closePopup();
    }
  </script>
</body>
</html>
