<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body {
      font-family: "Prompt", sans-serif;
      margin: 0; padding: 0;
      background: linear-gradient(135deg, #74ebd5 0%, #ACB6E5 100%);
      color: #333;
    }
    header {
      background: #2d3436;
      color: #fff;
      padding: 20px;
      text-align: center;
      font-size: 24px;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    .container {
      padding: 20px;
      max-width: 1200px;
      margin: auto;
    }
    .menu-btn {
      display: inline-block;
      margin: 5px;
      padding: 12px 20px;
      background: linear-gradient(45deg, #ff6b6b, #feca57);
      border: none; border-radius: 8px;
      font-size: 16px; font-weight: bold;
      color: #fff;
      cursor: pointer;
      transition: 0.3s;
    }
    .menu-btn:hover { transform: scale(1.05); }
    .menu {
      display: none;
      margin-top: 20px;
      padding: 20px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      animation: fadeIn 0.5s ease;
    }
    h3 { color: #2d3436; }
    input, select, button {
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin: 5px 0;
    }
    button.save-btn {
      background: linear-gradient(45deg, #1dd1a1, #10ac84);
      color: #fff; border: none; font-weight: bold;
    }
    button.save-btn:hover { opacity: 0.9; }
    .student-card {
      display: flex; align-items: center;
      justify-content: space-between;
      background: #f1f2f6;
      padding: 10px;
      margin: 5px 0;
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .status-btn {
      margin: 2px;
      padding: 8px 12px;
      border-radius: 50%;
      color: #fff; font-weight: bold;
      cursor: pointer;
      opacity: 0.4; transition: 0.2s;
    }
    .status-btn.active { opacity: 1; transform: scale(1.1); }
    .‡∏°‡∏≤ { background:#2ecc71; }
    .‡∏Ç‡∏≤‡∏î { background:#e74c3c; }
    .‡∏•‡∏≤‡∏Å‡∏¥‡∏à { background:#9b59b6; }
    .‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢ { background:#e67e22; }
    .‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° { background:#f1c40f; color:#000; }
    table {
      width: 100%; border-collapse: collapse; margin-top: 15px;
      background: #fff; border-radius: 12px; overflow: hidden;
    }
    th, td {
      padding: 10px; border-bottom: 1px solid #ddd; text-align: center;
    }
    th { background: #74b9ff; color:#fff; }
    @keyframes fadeIn {
      from {opacity:0; transform:translateY(10px);}
      to {opacity:1; transform:translateY(0);}
    }
  </style>
</head>
<body>
  <header>üìò ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</header>
  <div class="container">
    <button class="menu-btn" onclick="showTab('menu1')">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
    <button class="menu-btn" onclick="showTab('menu2')">‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <button class="menu-btn" onclick="showTab('menu3')">üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π 1 -->
    <div id="menu1" class="menu">
      <h3>‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <input type="date" id="dateInput" max="<?= new Date().toISOString().split('T')[0] ?>">
      <br>‡∏´‡πâ‡∏≠‡∏á: <select id="roomSelect"></select>
      ‡∏ß‡∏¥‡∏ä‡∏≤: <select id="subjectSelect"></select>
      <button onclick="loadStudents()">üìã ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</button>
      <div id="studentList"></div>
      <button class="save-btn" onclick="saveAttendance()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    </div>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π 2 -->
    <div id="menu2" class="menu">
      <h3>‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
      <h4>üè´ ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
      <!-- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
<div class="card p-4 bg-white rounded-2xl shadow-md">
  <h2 class="text-lg font-bold mb-3 text-indigo-600">üìö ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>

  <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
  <div class="flex gap-2 mb-3">
    <input type="text" id="classroomName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" 
           class="border rounded-lg px-3 py-2 flex-1">
    <button onclick="addClassroom()" 
            class="bg-green-500 text-white px-4 py-2 rounded-lg shadow">
      ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    </button>
  </div>

  <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
  <ul id="classroomList" class="space-y-2"></ul>
</div>

<!-- Modal ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
<div id="importModal" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-50">
  <div class="bg-white p-6 rounded-lg shadow-lg w-1/2">
    <h3 class="text-lg font-bold mb-4">üìë ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
    <div id="previewArea" class="max-h-60 overflow-y-auto border p-2 mb-3"></div>
    <div class="flex justify-end gap-2">
      <button onclick="confirmImport()" class="bg-blue-500 text-white px-4 py-2 rounded">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      <button onclick="closeModal()" class="bg-gray-400 text-white px-4 py-2 rounded">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
    </div>
  </div>
</div>

      <h4>üìö ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</h4>
      <div id="subjectManage"></div>
    </div>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π 3 -->
    <div id="menu3" class="menu">
      <h3>üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <input type="date" id="historyDate">
      ‡∏´‡πâ‡∏≠‡∏á: <select id="historyRoom"></select>
      ‡∏ß‡∏¥‡∏ä‡∏≤: <select id="historySubject"></select>
      <button onclick="loadHistory()">üîé ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      <div id="historyTable"></div>
    </div>
  </div>

<script>
  function showTab(tab) {
    document.querySelectorAll(".menu").forEach(m=>m.style.display="none");
    document.getElementById(tab).style.display="block";
  }
  function toggleStatus(el,status){
    el.parentNode.querySelectorAll(".status-btn").forEach(btn=>btn.classList.remove("active"));
    el.classList.add("active");
    el.setAttribute("data-status",status);
  }
  // ‡∏™‡πà‡∏ß‡∏ô JS ‡∏Ç‡∏≠‡∏á google.script.run ‡∏à‡∏∞‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏ú‡∏°‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö
</script>
</body>
</html>
