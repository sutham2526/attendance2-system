<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 700;
            font-size: 16px;
        }
        
        .calendar-day:hover {
            background-color: #e0e7ff;
        }
        
        .calendar-day.selected {
            background-color: #4f46e5;
            color: white;
        }
        
        .calendar-day.today {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .calendar-day.has-records {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .calendar-day.future {
            color: #d1d5db;
            cursor: not-allowed;
        }
        
        .status-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .status-btn.active {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal.show .modal-content {
            transform: scale(1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div>
                    <h1 class="text-2xl font-bold text-indigo-800">üìö ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
                    <div class="flex items-center space-x-4 mt-1">
                        <p class="text-xs text-gray-500">üíæ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
                        <div class="flex items-center space-x-2">
                            <div id="sync-status" class="flex items-center space-x-1">
                                <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                                <span class="text-xs text-gray-500">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span>
                            </div>
                            <button id="google-sync-btn" class="text-xs bg-blue-500 text-white px-3 py-1 rounded-full hover:bg-blue-600 transition-colors">
                                üåê ‡πÄ‡∏õ‡∏¥‡∏î‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
                            </button>
                        </div>
                    </div>
                </div>
                <div class="text-sm text-gray-600">
                    ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: <span id="current-date"></span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <div class="bg-white border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <nav class="flex space-x-8">
                <button id="tab-attendance" class="py-4 px-1 border-b-2 border-indigo-500 text-indigo-600 font-medium">
                    ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤
                </button>
                <button id="tab-manage" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
                <button id="tab-history" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
                    ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                </button>
                <button id="tab-sync" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
                    üåê ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
                </button>
            </nav>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Attendance Tab -->
        <div id="content-attendance" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Calendar -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</h3>
                        
                        <!-- Calendar Header -->
                        <div class="flex justify-between items-center mb-4">
                            <button id="prev-month" class="p-2 hover:bg-gray-100 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                </svg>
                            </button>
                            <h4 id="calendar-month" class="text-lg font-semibold"></h4>
                            <button id="next-month" class="p-2 hover:bg-gray-100 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <!-- Day Headers -->
                        <div class="calendar-grid mb-2">
                            <div class="text-center text-sm font-medium text-red-500 py-2">‡∏≠‡∏≤</div>
                            <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏à</div>
                            <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏≠</div>
                            <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏û</div>
                            <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏û‡∏§</div>
                            <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏®</div>
                            <div class="text-center text-sm font-medium text-red-500 py-2">‡∏™</div>
                        </div>
                        
                        <!-- Calendar Days -->
                        <div id="calendar-days" class="calendar-grid"></div>
                        
                        <div class="mt-4 text-center">
                            <p class="text-sm text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: <span id="selected-date" class="font-medium text-indigo-600"></span></p>
                        </div>
                    </div>
                </div>

                <!-- Attendance Form -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-6">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                        
                        <!-- Class and Subject Selection -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                                <select id="class-select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏¥‡∏ä‡∏≤</label>
                                <select id="subject-select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤ --</option>
                                </select>
                            </div>
                        </div>

                        <!-- Status Selection -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-3">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                            <div class="flex justify-center space-x-4 mb-2">
                                <button class="status-btn bg-green-500 text-white" data-status="/">‚úì</button>
                                <button class="status-btn bg-red-100 text-red-800" data-status="‡∏Ç">‡∏Ç</button>
                                <button class="status-btn bg-orange-100 text-orange-800" data-status="‡∏•">‡∏•</button>
                                <button class="status-btn bg-blue-100 text-blue-800" data-status="‡∏õ">‡∏õ</button>
                                <button class="status-btn bg-purple-100 text-purple-800" data-status="‡∏™">‡∏™</button>
                            </div>
                            <div class="text-xs text-gray-500 text-center">
                                ‚úì = ‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô, ‡∏Ç = ‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô, ‡∏• = ‡∏•‡∏≤, ‡∏õ = ‡∏õ‡πà‡∏ß‡∏¢, ‡∏™ = ‡∏™‡∏≤‡∏¢
                            </div>
                        </div>

                        <!-- Student List -->
                        <div id="student-list-container">
                            <div class="text-center py-12 text-gray-500">
                                <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                                </svg>
                                <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤</p>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex justify-end space-x-3 mt-6">
                            <button id="cancel-attendance" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                            <button id="save-attendance" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50" disabled>
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manage Tab -->
        <div id="content-manage" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Classes Management -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                        <button id="add-class" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                            + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                        </button>
                    </div>
                    <div id="classes-list" class="space-y-3">
                        <!-- Classes will be rendered here -->
                    </div>
                </div>

                <!-- Subjects Management -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                        <button id="add-subject" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                            + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤
                        </button>
                    </div>
                    <div id="subjects-list" class="space-y-3">
                        <!-- Subjects will be rendered here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- History Tab -->
        <div id="content-history" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                <!-- Filters and Calendar -->
                <div class="lg:col-span-1">
                    <!-- Date Range Filter -->
                    <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</h3>
                        
                        <!-- Calendar for History -->
                        <div class="mb-4">
                            <!-- Calendar Header -->
                            <div class="flex justify-between items-center mb-4">
                                <button id="history-prev-month" class="p-2 hover:bg-gray-100 rounded-lg">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                    </svg>
                                </button>
                                <h4 id="history-calendar-month" class="text-sm font-semibold"></h4>
                                <button id="history-next-month" class="p-2 hover:bg-gray-100 rounded-lg">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </button>
                            </div>
                            
                            <!-- Day Headers -->
                            <div class="grid grid-cols-7 gap-1 mb-2">
                                <div class="text-center text-xs font-medium text-red-500 py-1">‡∏≠‡∏≤</div>
                                <div class="text-center text-xs font-medium text-gray-600 py-1">‡∏à</div>
                                <div class="text-center text-xs font-medium text-gray-600 py-1">‡∏≠</div>
                                <div class="text-center text-xs font-medium text-gray-600 py-1">‡∏û</div>
                                <div class="text-center text-xs font-medium text-gray-600 py-1">‡∏û‡∏§</div>
                                <div class="text-center text-xs font-medium text-gray-600 py-1">‡∏®</div>
                                <div class="text-center text-xs font-medium text-red-500 py-1">‡∏™</div>
                            </div>
                            
                            <!-- Calendar Days -->
                            <div id="history-calendar-days" class="grid grid-cols-7 gap-1"></div>
                        </div>
                        
                        <!-- Selected Date Range Display -->
                        <div class="text-center mt-4">
                            <p class="text-sm text-gray-600">‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</p>
                            <p id="selected-date-range" class="font-medium text-indigo-600 text-sm">‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</p>
                        </div>
                        
                        <!-- Quick Date Filters -->
                        <div class="mt-4 space-y-2">
                            <h5 class="text-sm font-medium text-gray-700">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤:</h5>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="setQuickDateFilter('today')" class="px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                                <button onclick="setQuickDateFilter('week')" class="px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</button>
                                <button onclick="setQuickDateFilter('month')" class="px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</button>
                                <button onclick="setQuickDateFilter('all')" class="px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            </div>
                        </div>

                    </div>
                    
                    <!-- Class and Subject Filters -->
                    <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                                <select id="filter-class" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                                    <option value="">‡∏ó‡∏∏‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏¥‡∏ä‡∏≤</label>
                                <select id="filter-subject" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                                    <option value="">‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Summary -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-green-600">‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</span>
                                <span id="summary-present" class="font-semibold">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-red-600">‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</span>
                                <span id="summary-absent" class="font-semibold">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-orange-600">‡∏•‡∏≤:</span>
                                <span id="summary-leave" class="font-semibold">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-blue-600">‡∏õ‡πà‡∏ß‡∏¢:</span>
                                <span id="summary-sick" class="font-semibold">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-purple-600">‡∏™‡∏≤‡∏¢:</span>
                                <span id="summary-late" class="font-semibold">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- History Records -->
                <div class="lg:col-span-3">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-lg font-semibold text-gray-800">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                            <div class="flex flex-wrap gap-2">
                                <button id="export-excel" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                                    üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                                </button>
                                <button id="export-pdf" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                                    üìÑ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF
                                </button>
                                <button id="clear-history" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                                    üóëÔ∏è ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                                </button>
                            </div>
                        </div>
                        <div id="history-list" class="space-y-4">
                            <div class="text-center py-12 text-gray-500">
                                <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cloud Sync Tab -->
        <div id="content-sync" class="tab-content hidden">
            <div class="max-w-4xl mx-auto">
                <!-- Connection Status -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">üåê ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h3>
                        <div id="connection-indicator" class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-gray-400 rounded-full"></div>
                            <span class="text-sm text-gray-600">‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</span>
                        </div>
                    </div>
                    
                    <div id="not-connected" class="text-center py-8">
                        <div class="mb-4">
                            <svg class="w-16 h-16 mx-auto text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"></path>
                            </svg>
                        </div>
                        <h4 class="text-lg font-medium text-gray-800 mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</h4>
                        <p class="text-gray-600 mb-6">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</p>
                        
                        <!-- ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ -->
                        <div class="space-y-4 max-w-md mx-auto">
                            <button id="connect-google" class="w-full px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-medium">
                                üåê ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏´‡∏°‡πà
                            </button>
                            
                            <div class="text-gray-500 text-sm">‡∏´‡∏£‡∏∑‡∏≠</div>
                            
                            <div class="space-y-3">
                                <input type="text" id="sync-code-input" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô" 
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center font-mono text-sm">
                                <button id="join-sync" class="w-full px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-medium">
                                    üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="connected" class="hidden">
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                <span class="text-green-800 font-medium">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</span>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå</label>
                                <div class="flex items-center space-x-2">
                                    <div class="flex-1 px-3 py-2 bg-gray-50 rounded-lg text-sm font-mono text-gray-800 break-all" id="sync-id-display">
                                        ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™...
                                    </div>
                                    <button id="copy-sync-code" class="px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 text-sm font-medium whitespace-nowrap">
                                        üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
                                    </button>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå</label>
                                <div id="sync-info" class="px-3 py-2 bg-gray-50 rounded-lg text-sm text-gray-600">
                                    ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex flex-wrap gap-3">
                            <button id="sync-now" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                                üîÑ ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </button>
                            <button id="view-sheet" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                                üëÅÔ∏è ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
                            </button>
                            <button id="disconnect-google" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                                üîå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sync Settings -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå</h3>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <h4 class="font-medium text-gray-800">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</h4>
                                <p class="text-sm text-gray-600">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="auto-sync" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div>
                                <h4 class="font-medium text-gray-800">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤</h4>
                                <p class="text-sm text-gray-600">‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="sync-existing" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Real Online Storage Setup -->
                <div class="bg-green-50 border border-green-200 rounded-xl p-6 mb-6">
                    <h3 class="text-lg font-semibold text-green-800 mb-4">üåê ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏à‡∏£‡∏¥‡∏á</h3>
                    
                    <div class="space-y-4 text-sm text-green-700">
                        <div class="bg-white border border-green-200 rounded-lg p-4">
                            <h4 class="font-semibold text-green-800 mb-2">‚ú® ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡πâ‡∏ß!</h4>
                            <p class="mb-3">‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á</p>
                            
                            <div class="space-y-3">
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                    <h5 class="font-semibold text-blue-800 mb-2">üéØ ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 1: JSONBin.io (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)</h5>
                                    <ul class="list-disc list-inside space-y-1 text-blue-700 text-sm">
                                        <li><strong>‡∏ü‡∏£‡∏µ:</strong> 100,000 requests/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</li>
                                        <li><strong>‡∏á‡πà‡∏≤‡∏¢:</strong> ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
                                        <li><strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ:</strong> ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏µ‡πà jsonbin.io ‚Üí ‡πÑ‡∏î‡πâ API Key ‚Üí ‡πÉ‡∏™‡πà‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î</li>
                                        <li><strong>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:</strong> ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å-‡∏Å‡∏•‡∏≤‡∏á</li>
                                    </ul>
                                </div>
                                
                                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                                    <h5 class="font-semibold text-orange-800 mb-2">üî• ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 2: Firebase Realtime Database</h5>
                                    <ul class="list-disc list-inside space-y-1 text-orange-700 text-sm">
                                        <li><strong>‡∏ü‡∏£‡∏µ:</strong> 1GB ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• + 10GB bandwidth/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</li>
                                        <li><strong>Real-time:</strong> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</li>
                                        <li><strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ:</strong> ‡∏™‡∏£‡πâ‡∏≤‡∏á Firebase Project ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î Realtime Database</li>
                                        <li><strong>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:</strong> ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ real-time</li>
                                    </ul>
                                </div>
                                
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-3">
                                    <h5 class="font-semibold text-purple-800 mb-2">‚ö° ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 3: Supabase</h5>
                                    <ul class="list-disc list-inside space-y-1 text-purple-700 text-sm">
                                        <li><strong>‡∏ü‡∏£‡∏µ:</strong> 500MB ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• + 2GB bandwidth/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</li>
                                        <li><strong>PostgreSQL:</strong> ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á</li>
                                        <li><strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ:</strong> ‡∏™‡∏£‡πâ‡∏≤‡∏á Supabase Project ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á attendance_data</li>
                                        <li><strong>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:</strong> ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö SQL</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white border border-green-200 rounded-lg p-4">
                            <h4 class="font-semibold text-green-800 mb-2">üõ†Ô∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö JSONBin.io):</h4>
                            <ol class="list-decimal list-inside space-y-1 text-green-700 text-sm">
                                <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà <a href="https://jsonbin.io" target="_blank" class="text-blue-600 underline">jsonbin.io</a> ‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (‡∏ü‡∏£‡∏µ)</li>
                                <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà API Keys ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á API Key ‡πÉ‡∏´‡∏°‡πà</li>
                                <li>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å API Key ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ</li>
                                <li>‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ <code class="bg-gray-100 px-1 rounded">$2a$10$m2.faiLjofX9YhqJkatOgukVcoDcZxcynRihjWCSGsIn1uQ/PJUqe</code></li>
                                <li>‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ API Key ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</li>
                                <li>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå</li>
                            </ol>
                        </div>
                        
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <h4 class="font-semibold text-yellow-800 mb-2">‚ö†Ô∏è ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</h4>
                            <ul class="list-disc list-inside space-y-1 text-yellow-700 text-sm">
                                <li><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢:</strong> API Key ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö</li>
                                <li><strong>‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î:</strong> ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ü‡∏£‡∏µ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
                                <li><strong>‡∏™‡∏≥‡∏£‡∏≠‡∏á:</strong> ‡∏Ñ‡∏ß‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞</li>
                                <li><strong>‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</strong> ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Technical Information -->
                <div class="bg-gray-50 border border-gray-200 rounded-xl p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">üîß ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå</h3>
                    
                    <div class="space-y-4 text-sm text-gray-700">
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-800 mb-2">üíæ ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</h4>
                            <ul class="list-disc list-inside space-y-1">
                                <li><strong>localStorage</strong> - ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏≤‡∏ß‡∏£‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå (‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡πá‡∏ö)</li>
                                <li><strong>sessionStorage</strong> - ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ó‡πá‡∏ö (‡∏´‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå)</li>
                                <li><strong>‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå</strong> - ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô Key ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</li>
                                <li><strong>‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏à‡∏£‡∏¥‡∏á</strong> - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
                            </ul>
                        </div>
                        
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-800 mb-2">‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö:</h4>
                            <ul class="list-disc list-inside space-y-1">
                                <li><strong>‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</strong> - ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å URL ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
                                <li><strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå</strong> - ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏ö‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏à‡∏£‡∏¥‡∏á</li>
                                <li><strong>‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå</strong> - ‡∏ö‡∏≤‡∏á‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡∏≤‡∏à‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
                                <li><strong>‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏à‡∏£‡∏¥‡∏á</strong> - ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏î‡πâ‡∏ß‡∏¢ Browser Storage</li>
                            </ul>
                        </div>
                        
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-800 mb-2">üîç ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ:</h4>
                            <ul class="list-disc list-inside space-y-1">
                                <li><strong>URL ‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô</strong> - ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡∏Ñ‡∏ô‡∏•‡∏∞‡∏ï‡∏±‡∏ß</li>
                                <li><strong>‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô</strong> - Chrome ‡∏Å‡∏±‡∏ö Safari ‡∏°‡∏µ Storage ‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô</li>
                                <li><strong>‡πÇ‡∏´‡∏°‡∏î‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</strong> - Incognito/Private mode ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
                                <li><strong>‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå</strong> - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß</li>
                                <li><strong>‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</strong> - ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
                            </ul>
                        </div>
                        
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <h4 class="font-semibold text-yellow-800 mb-2">üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå:</h4>
                            <ol class="list-decimal list-inside space-y-1 text-yellow-700">
                                <li><strong>‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</strong> - ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏£‡∏Å‡πÑ‡∏õ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á</li>
                                <li><strong>‡πÉ‡∏ä‡πâ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</strong> - ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ Chrome ‡∏´‡∏£‡∏∑‡∏≠ Edge</li>
                                <li><strong>‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</strong> - ‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏Å‡∏ï‡∏¥</li>
                                <li><strong>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</strong> - ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
                                <li><strong>‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</strong> - ‡∏Å‡∏î F5 ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- Instructions -->
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                    <h3 class="text-lg font-semibold text-blue-800 mb-4">üìã ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h3>
                    
                    <div class="space-y-4 text-sm text-blue-700">
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                            <h4 class="font-semibold text-yellow-800 mb-2">üéØ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏£‡∏Å (‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß):</h4>
                            <ol class="list-decimal list-inside space-y-1 text-yellow-700">
                                <li>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "üåê ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏´‡∏°‡πà"</li>
                                <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÅ‡∏•‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå</li>
                                <li>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô</li>
                            </ol>
                        </div>
                        
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="font-semibold text-green-800 mb-2">üì± ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÜ:</h4>
                            <ol class="list-decimal list-inside space-y-1 text-green-700">
                                <li>‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏´‡∏°‡πà</li>
                                <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "üåê ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå"</li>
                                <li>‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á "‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô"</li>
                                <li>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå"</li>
                                <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥!</li>
                            </ol>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg mb-4">
                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-green-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div class="text-sm text-green-800">
                                <h4 class="font-medium mb-1">‚ú® ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà</h4>
                                <ul class="list-disc list-inside space-y-1">
                                    <li><strong>‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</strong> - ‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</li>
                                    <li><strong>‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</strong> - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</li>
                                    <li><strong>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</strong> - ‡πÅ‡∏Ñ‡πà‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
                                    <li><strong>‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</strong> - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏â‡∏û‡∏≤‡∏∞</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-red-50 border border-red-200 rounded-lg">
                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-red-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z"></path>
                            </svg>
                            <div class="text-sm text-red-800">
                                <h4 class="font-medium mb-1">üîß ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå</h4>
                                <ul class="list-disc list-inside space-y-1">
                                    <li><strong>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™</strong> - ‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà</li>
                                    <li><strong>‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</strong> - ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</li>
                                    <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà</strong> - ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà</li>
                                    <li><strong>‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</strong> - ‡∏•‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Class Modal -->
    <div id="class-modal" class="modal">
        <div class="modal-content w-full max-w-2xl p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 id="class-modal-title" class="text-xl font-semibold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà</h3>
                <button id="close-class-modal" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <form id="class-form">
                <input type="hidden" id="class-id">
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                    <input type="text" id="class-code" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" required>
                </div>
                
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-3">
                        <label class="block text-sm font-medium text-gray-700">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                        <div class="flex space-x-2">
                            <input type="file" id="excel-file" accept=".xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,application/octet-stream" class="hidden">
                            <button type="button" id="import-excel" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">
                                üìä ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Excel
                            </button>
                            <button type="button" id="add-student" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">
                                + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                            </button>
                        </div>
                    </div>
                    
                    <div id="students-container" class="space-y-2 max-h-60 overflow-y-auto border border-gray-200 rounded-lg p-3">
                        <p class="text-gray-500 text-center py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancel-class" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Subject Modal -->
    <div id="subject-modal" class="modal">
        <div class="modal-content w-full max-w-md p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 id="subject-modal-title" class="text-xl font-semibold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà</h3>
                <button id="close-subject-modal" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <form id="subject-form">
                <input type="hidden" id="subject-id">
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤</label>
                    <input type="text" id="subject-name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" required>
                </div>
                
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancel-subject" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content w-full max-w-md p-6">
            <h3 class="text-xl font-semibold mb-4">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö</h3>
            <p id="confirm-message" class="text-gray-600 mb-6">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
            <div class="flex justify-end space-x-3">
                <button id="confirm-cancel" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                    ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
                <button id="confirm-delete" class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
                    ‡∏•‡∏ö
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast bg-green-500">
        <span id="toast-message">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</span>
    </div>

    <script>
        // Data Storage
        let classes = JSON.parse(localStorage.getItem('classes')) || [
            {
                id: 1,
                code: '‡∏°.1/1',
                students: [
                    { id: 1, number: '01', name: '‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ', studentId: '123456' },
                    { id: 2, number: '02', name: '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏£‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', studentId: '123457' },
                    { id: 3, number: '03', name: '‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡πÄ‡∏Å‡πà‡∏á‡∏Å‡∏≤‡∏à', studentId: '123458' }
                ]
            },
            {
                id: 2,
                code: '‡∏°.2/1',
                students: [
                    { id: 1, number: '01', name: '‡∏ô‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ‡∏¥‡∏ô ‡∏î‡∏µ‡πÄ‡∏•‡∏¥‡∏®', studentId: '123459' },
                    { id: 2, number: '02', name: '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏Å‡∏ô‡∏Å‡∏ß‡∏£‡∏£‡∏ì ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ', studentId: '123460' }
                ]
            }
        ];

        let subjects = JSON.parse(localStorage.getItem('subjects')) || [
            { id: 1, name: '‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô 1' },
            { id: 2, name: '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô 1' },
            { id: 3, name: '‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô 1' }
        ];

        let attendanceRecords = JSON.parse(localStorage.getItem('attendanceRecords')) || [];

        // Global Variables
        let currentDate = new Date();
        let selectedDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();
        let selectedStatus = '/';
        let editingClass = null;
        let editingSubject = null;
        
        // Cloud Sync Integration - Real Online Storage
        let isCloudSyncConnected = localStorage.getItem('isCloudSyncConnected') === 'true';
        let cloudSyncId = localStorage.getItem('cloudSyncId') || null;
        let autoSyncEnabled = localStorage.getItem('autoSyncEnabled') === 'true';
        let currentUser = null;
        let db = null;
        
        // Real Cloud Storage Configuration
        const CLOUD_STORAGE_BASE = 'https://api.jsonbin.io/v3/b/'; // JSONBin.io API
        const API_KEY = '$2a$10$9vKvKvKvKvKvKvKvKvKvKu.dummy.key.replace.with.real'; // ‚ö†Ô∏è ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ API Key ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å jsonbin.io
        const SYNC_CHECK_INTERVAL = 10000; // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        let syncInterval = null;
        
        // Alternative: Firebase Realtime Database Configuration
        const FIREBASE_CONFIG = {
            apiKey: "your-firebase-api-key",
            authDomain: "your-project.firebaseapp.com",
            databaseURL: "https://your-project-default-rtdb.firebaseio.com/",
            projectId: "your-project-id",
            storageBucket: "your-project.appspot.com",
            messagingSenderId: "123456789",
            appId: "your-app-id"
        };
        
        // Alternative: Supabase Configuration
        const SUPABASE_URL = 'https://your-project.supabase.co';
        const SUPABASE_ANON_KEY = 'your-supabase-anon-key';
        
        // History Calendar Variables
        let historyCurrentMonth = currentDate.getMonth();
        let historyCurrentYear = currentDate.getFullYear();
        let selectedStartDate = null;
        let selectedEndDate = null;
        let isSelectingRange = false;

        // Save data to localStorage and cloud
        function saveData() {
            localStorage.setItem('classes', JSON.stringify(classes));
            localStorage.setItem('subjects', JSON.stringify(subjects));
            localStorage.setItem('attendanceRecords', JSON.stringify(attendanceRecords));
            
            // Auto sync to cloud if enabled
            if (autoSyncEnabled && isCloudSyncConnected) {
                syncToCloud();
            }
        }
        
        // Initialize Cloud Sync
        async function initializeCloudSync() {
            try {
                // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
                if (!cloudSyncId) {
                    cloudSyncId = generateSyncId();
                    localStorage.setItem('cloudSyncId', cloudSyncId);
                    
                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå
                    await createInitialCloudData();
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå
                    await loadFromCloud();
                }
                
                // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                startAutoSync();
                
                return true;
            } catch (error) {
                console.error('Error initializing cloud sync:', error);
                return false;
            }
        }
        
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
        function generateSyncId() {
            const timestamp = Date.now();
            const random = Math.random().toString(36).substr(2, 9);
            return `sync_${timestamp}_${random}`;
        }
        
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå
        async function createInitialCloudData() {
            const initialData = {
                classes: classes,
                subjects: subjects,
                attendanceRecords: attendanceRecords,
                lastSync: new Date().toISOString(),
                syncId: cloudSyncId,
                createdAt: new Date().toISOString(),
                devices: [getDeviceInfo()]
            };
            
            await saveToCloudStorage(initialData);
        }
        
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
        function getDeviceInfo() {
            return {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                timestamp: new Date().toISOString(),
                id: Math.random().toString(36).substr(2, 9)
            };
        }
        
        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        function startAutoSync() {
            if (syncInterval) {
                clearInterval(syncInterval);
            }
            
            syncInterval = setInterval(async () => {
                if (isCloudSyncConnected && autoSyncEnabled) {
                    await checkAndSyncData();
                }
            }, SYNC_CHECK_INTERVAL);
        }
        
        // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        function stopAutoSync() {
            if (syncInterval) {
                clearInterval(syncInterval);
                syncInterval = null;
            }
        }
        
        // Load data from cloud
        async function loadFromCloud() {
            if (!cloudSyncId) return false;
            
            try {
                showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå...', 'success');
                
                const cloudData = await getCloudData();
                
                if (cloudData && cloudData.syncId === cloudSyncId) {
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    const cloudLastSync = new Date(cloudData.lastSync || 0);
                    const localLastSync = new Date(localStorage.getItem('lastSync') || 0);
                    
                    if (cloudLastSync > localLastSync) {
                        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå
                        classes = cloudData.classes || [];
                        subjects = cloudData.subjects || [];
                        attendanceRecords = cloudData.attendanceRecords || [];
                        
                        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage
                        localStorage.setItem('classes', JSON.stringify(classes));
                        localStorage.setItem('subjects', JSON.stringify(subjects));
                        localStorage.setItem('attendanceRecords', JSON.stringify(attendanceRecords));
                        localStorage.setItem('lastSync', cloudData.lastSync);
                        
                        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI
                        updateSelects();
                        renderClasses();
                        renderSubjects();
                        renderCalendar();
                        
                        showToast('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    } else {
                        showToast('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß', 'success');
                    }
                    
                    return true;
                } else if (cloudData && cloudData.syncId !== cloudSyncId) {
                    showToast('‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠', 'warning');
                    return false;
                }
                
                return false;
            } catch (error) {
                console.error('Error loading from cloud:', error);
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡πÑ‡∏î‡πâ', 'warning');
                return false;
            }
        }
        
        // Real Cloud Storage Functions
        
        // Option 1: JSONBin.io - Simple JSON Storage
        async function getCloudDataFromJSONBin() {
            try {
                console.log('üåê ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å JSONBin.io...');
                
                const response = await fetch(`${CLOUD_STORAGE_BASE}${cloudSyncId}`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': API_KEY,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å JSONBin.io ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    return result.record;
                } else if (response.status === 404) {
                    console.log('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô JSONBin.io');
                    return null;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('‚ùå Error loading from JSONBin.io:', error);
                return null;
            }
        }
        
        async function saveCloudDataToJSONBin(data) {
            try {
                console.log('üåê ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á JSONBin.io...');
                
                let response;
                if (cloudSyncId && cloudSyncId !== 'new') {
                    // Update existing bin
                    response = await fetch(`${CLOUD_STORAGE_BASE}${cloudSyncId}`, {
                        method: 'PUT',
                        headers: {
                            'X-Master-Key': API_KEY,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });
                } else {
                    // Create new bin
                    response = await fetch('https://api.jsonbin.io/v3/b', {
                        method: 'POST',
                        headers: {
                            'X-Master-Key': API_KEY,
                            'Content-Type': 'application/json',
                            'X-Bin-Name': `attendance_${Date.now()}`
                        },
                        body: JSON.stringify(data)
                    });
                }
                
                if (response.ok) {
                    const result = await response.json();
                    if (!cloudSyncId || cloudSyncId === 'new') {
                        cloudSyncId = result.metadata.id;
                        localStorage.setItem('cloudSyncId', cloudSyncId);
                    }
                    console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á JSONBin.io ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    return true;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('‚ùå Error saving to JSONBin.io:', error);
                return false;
            }
        }
        
        // Option 2: Firebase Realtime Database
        async function getCloudDataFromFirebase() {
            try {
                console.log('üî• ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase...');
                
                const response = await fetch(`${FIREBASE_CONFIG.databaseURL}/attendance/${cloudSyncId}.json`);
                
                if (response.ok) {
                    const data = await response.json();
                    if (data) {
                        console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        return data;
                    } else {
                        console.log('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Firebase');
                        return null;
                    }
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('‚ùå Error loading from Firebase:', error);
                return null;
            }
        }
        
        async function saveCloudDataToFirebase(data) {
            try {
                console.log('üî• ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Firebase...');
                
                if (!cloudSyncId) {
                    cloudSyncId = generateSyncId();
                    localStorage.setItem('cloudSyncId', cloudSyncId);
                }
                
                const response = await fetch(`${FIREBASE_CONFIG.databaseURL}/attendance/${cloudSyncId}.json`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Firebase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    return true;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('‚ùå Error saving to Firebase:', error);
                return false;
            }
        }
        
        // Option 3: Supabase
        async function getCloudDataFromSupabase() {
            try {
                console.log('‚ö° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Supabase...');
                
                const response = await fetch(`${SUPABASE_URL}/rest/v1/attendance_data?sync_id=eq.${cloudSyncId}`, {
                    method: 'GET',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result && result.length > 0) {
                        console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Supabase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        return result[0].data;
                    } else {
                        console.log('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Supabase');
                        return null;
                    }
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('‚ùå Error loading from Supabase:', error);
                return null;
            }
        }
        
        async function saveCloudDataToSupabase(data) {
            try {
                console.log('‚ö° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Supabase...');
                
                if (!cloudSyncId) {
                    cloudSyncId = generateSyncId();
                    localStorage.setItem('cloudSyncId', cloudSyncId);
                }
                
                const payload = {
                    sync_id: cloudSyncId,
                    data: data,
                    updated_at: new Date().toISOString()
                };
                
                // Try to update first
                let response = await fetch(`${SUPABASE_URL}/rest/v1/attendance_data?sync_id=eq.${cloudSyncId}`, {
                    method: 'PATCH',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify(payload)
                });
                
                // If update fails, try to insert
                if (!response.ok) {
                    response = await fetch(`${SUPABASE_URL}/rest/v1/attendance_data`, {
                        method: 'POST',
                        headers: {
                            'apikey': SUPABASE_ANON_KEY,
                            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(payload)
                    });
                }
                
                if (response.ok) {
                    console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Supabase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    return true;
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('‚ùå Error saving to Supabase:', error);
                return false;
            }
        }
        
        // Main cloud storage functions (choose your preferred method)
        async function getCloudData() {
            // You can switch between different cloud storage options here
            // Option 1: JSONBin.io (recommended for simplicity)
            return await getCloudDataFromJSONBin();
            
            // Option 2: Firebase Realtime Database
            // return await getCloudDataFromFirebase();
            
            // Option 3: Supabase
            // return await getCloudDataFromSupabase();
            
            // Fallback to local storage simulation
            // return await getCloudDataFromLocalStorage();
        }
        
        async function saveToCloudStorage(data) {
            // You can switch between different cloud storage options here
            // Option 1: JSONBin.io (recommended for simplicity)
            return await saveCloudDataToJSONBin(data);
            
            // Option 2: Firebase Realtime Database
            // return await saveCloudDataToFirebase(data);
            
            // Option 3: Supabase
            // return await saveCloudDataToSupabase(data);
            
            // Fallback to local storage simulation
            // return await saveToLocalStorageSimulation(data);
        }
        
        // Fallback: Local Storage Simulation (original method)
        async function getCloudDataFromLocalStorage() {
            try {
                console.log('üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå:', cloudSyncId);
                
                // ‡πÉ‡∏ä‡πâ sessionStorage ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏à‡∏≥‡∏•‡∏≠‡∏á (‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ó‡πá‡∏ö‡πÑ‡∏î‡πâ)
                const cloudKey = 'attendance_sync_' + cloudSyncId;
                console.log('üîë ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ key:', cloudKey);
                
                // ‡∏•‡∏≠‡∏á‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å sessionStorage ‡∏Å‡πà‡∏≠‡∏ô
                let savedData = sessionStorage.getItem(cloudKey);
                console.log('üì± sessionStorage result:', savedData ? '‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' : '‡πÑ‡∏°‡πà‡∏û‡∏ö');
                
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô sessionStorage ‡πÉ‡∏´‡πâ‡∏´‡∏≤‡∏à‡∏≤‡∏Å localStorage
                if (!savedData) {
                    savedData = localStorage.getItem(cloudKey);
                    console.log('üíæ localStorage result:', savedData ? '‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' : '‡πÑ‡∏°‡πà‡∏û‡∏ö');
                    
                    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠‡πÉ‡∏ô localStorage ‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á sessionStorage
                    if (savedData) {
                        sessionStorage.setItem(cloudKey, savedData);
                        console.log('‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á sessionStorage ‡πÅ‡∏•‡πâ‡∏ß');
                    }
                }
                
                // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ ‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô localStorage
                if (!savedData) {
                    console.log('üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î...');
                    savedData = searchAllSyncCodes(cloudSyncId);
                    console.log('üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', savedData ? '‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' : '‡πÑ‡∏°‡πà‡∏û‡∏ö');
                }
                
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    console.log('‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå:', {
                        syncId: parsedData.syncId,
                        classes: parsedData.classes?.length || 0,
                        subjects: parsedData.subjects?.length || 0,
                        records: parsedData.attendanceRecords?.length || 0
                    });
                    return parsedData;
                }
                
                console.log('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå');
                return null;
            } catch (error) {
                console.error('‚ùå Error getting cloud data:', error);
                return null;
            }
        }
        
        async function saveToLocalStorageSimulation(data) {
            try {
                const cloudKey = 'attendance_sync_' + cloudSyncId;
                const dataString = JSON.stringify(data);
                
                console.log('üíæ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå:', {
                    cloudKey: cloudKey,
                    syncId: data.syncId,
                    dataSize: dataString.length,
                    classes: data.classes?.length || 0,
                    subjects: data.subjects?.length || 0,
                    records: data.attendanceRecords?.length || 0
                });
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô localStorage ‡πÅ‡∏•‡∏∞ sessionStorage
                localStorage.setItem(cloudKey, dataString);
                sessionStorage.setItem(cloudKey, dataString);
                
                console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                console.log('üîë Key ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:', cloudKey);
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                localStorage.setItem('lastSync', data.lastSync);
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const savedData = localStorage.getItem(cloudKey);
                if (savedData) {
                    console.log('‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage');
                } else {
                    console.log('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage ‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
                }
                
                return true;
            } catch (error) {
                console.error('‚ùå Error saving to cloud storage:', error);
                return false;
            }
        }
        
        // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏à‡∏≤‡∏Å localStorage ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function searchAllSyncCodes(targetSyncId) {
            try {
                console.log('üîç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå:', targetSyncId);
                console.log('üìä localStorage ‡∏°‡∏µ', localStorage.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
                console.log('üìä sessionStorage ‡∏°‡∏µ', sessionStorage.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
                
                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏∏‡∏Å key ‡πÉ‡∏ô localStorage ‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ CLOUD_STORAGE_BASE
                const localStorageKeys = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith(CLOUD_STORAGE_BASE)) {
                        localStorageKeys.push(key);
                        console.log('üîë ‡∏û‡∏ö localStorage key:', key);
                        
                        const data = localStorage.getItem(key);
                        if (data) {
                            try {
                                const parsedData = JSON.parse(data);
                                console.log('üìÑ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô key', key, ':', {
                                    syncId: parsedData.syncId,
                                    hasClasses: !!parsedData.classes,
                                    hasSubjects: !!parsedData.subjects,
                                    hasRecords: !!parsedData.attendanceRecords
                                });
                                
                                if (parsedData.syncId === targetSyncId) {
                                    // ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
                                    console.log('‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏ô localStorage:', key);
                                    return data;
                                }
                            } catch (parseError) {
                                console.warn('‚ö†Ô∏è Error parsing data for key:', key, parseError);
                            }
                        }
                    }
                }
                
                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô sessionStorage ‡∏î‡πâ‡∏ß‡∏¢
                const sessionStorageKeys = [];
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    if (key && key.startsWith(CLOUD_STORAGE_BASE)) {
                        sessionStorageKeys.push(key);
                        console.log('üîë ‡∏û‡∏ö sessionStorage key:', key);
                        
                        const data = sessionStorage.getItem(key);
                        if (data) {
                            try {
                                const parsedData = JSON.parse(data);
                                console.log('üìÑ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô key', key, ':', {
                                    syncId: parsedData.syncId,
                                    hasClasses: !!parsedData.classes,
                                    hasSubjects: !!parsedData.subjects,
                                    hasRecords: !!parsedData.attendanceRecords
                                });
                                
                                if (parsedData.syncId === targetSyncId) {
                                    // ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
                                    console.log('‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏ô sessionStorage:', key);
                                    return data;
                                }
                            } catch (parseError) {
                                console.warn('‚ö†Ô∏è Error parsing data for key:', key, parseError);
                            }
                        }
                    }
                }
                
                console.log('üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:');
                console.log('  - localStorage keys:', localStorageKeys);
                console.log('  - sessionStorage keys:', sessionStorageKeys);
                console.log('  - ‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:', targetSyncId);
                console.log('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå');
                
                return null;
            } catch (error) {
                console.error('‚ùå Error searching sync codes:', error);
                return null;
            }
        }
        
        // Save to cloud storage
        async function saveToCloudStorage(data) {
            try {
                const cloudKey = CLOUD_STORAGE_BASE + cloudSyncId;
                const dataString = JSON.stringify(data);
                
                console.log('üíæ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå:', {
                    cloudKey: cloudKey,
                    syncId: data.syncId,
                    dataSize: dataString.length,
                    classes: data.classes?.length || 0,
                    subjects: data.subjects?.length || 0,
                    records: data.attendanceRecords?.length || 0
                });
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô localStorage ‡πÅ‡∏•‡∏∞ sessionStorage
                localStorage.setItem(cloudKey, dataString);
                sessionStorage.setItem(cloudKey, dataString);
                
                console.log('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                console.log('üîë Key ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:', cloudKey);
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                localStorage.setItem('lastSync', data.lastSync);
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const savedData = localStorage.getItem(cloudKey);
                if (savedData) {
                    console.log('‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage');
                } else {
                    console.log('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage ‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
                }
                
                return true;
            } catch (error) {
                console.error('‚ùå Error saving to cloud storage:', error);
                return false;
            }
        }
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        async function checkAndSyncData() {
            try {
                const cloudData = await getCloudData();
                
                if (cloudData && cloudData.syncId === cloudSyncId) {
                    const cloudLastSync = new Date(cloudData.lastSync || 0);
                    const localLastSync = new Date(localStorage.getItem('lastSync') || 0);
                    
                    // ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏ß‡πà‡∏≤ ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
                    if (cloudLastSync > localLastSync) {
                        await loadFromCloud();
                    }
                }
            } catch (error) {
                console.error('Error checking sync data:', error);
            }
        }
        
        // Save data to cloud
        async function syncToCloud() {
            if (!cloudSyncId) return false;
            
            try {
                const dataToSync = {
                    classes: classes,
                    subjects: subjects,
                    attendanceRecords: attendanceRecords,
                    lastSync: new Date().toISOString(),
                    syncId: cloudSyncId,
                    devices: [getDeviceInfo()]
                };
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå
                const success = await saveToCloudStorage(dataToSync);
                
                if (success) {
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
                    const now = new Date();
                    const syncTime = now.toLocaleString('th-TH');
                    const syncInfo = document.getElementById('sync-info');
                    if (syncInfo) {
                        syncInfo.textContent = `‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${syncTime}`;
                    }
                    
                    return true;
                } else {
                    throw new Error('Failed to save to cloud storage');
                }
            } catch (error) {
                console.error('Error syncing to cloud:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
                return false;
            }
        }

        // Cloud Sync Functions
        async function connectToCloudSync() {
            try {
                showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå...', 'success');
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if (cloudSyncId) {
                    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå
                    const success = await loadFromCloud();
                    if (success) {
                        isCloudSyncConnected = true;
                        localStorage.setItem('isCloudSyncConnected', 'true');
                        updateConnectionStatus();
                        showConnectedUI();
                        startAutoSync();
                        showToast('‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡πÅ‡∏•‡πâ‡∏ß', 'success');
                        return;
                    }
                }
                
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
                const success = await initializeCloudSync();
                
                if (success) {
                    isCloudSyncConnected = true;
                    localStorage.setItem('isCloudSyncConnected', 'true');
                    
                    updateConnectionStatus();
                    showConnectedUI();
                    
                    // ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                    if (classes.length > 0 || subjects.length > 0 || attendanceRecords.length > 0) {
                        await syncToCloud();
                        showToast('‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß', 'success');
                    } else {
                        showToast('‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    }
                } else {
                    throw new Error('Failed to initialize cloud sync');
                }
            } catch (error) {
                console.error('Error connecting to cloud sync:', error);
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÑ‡∏î‡πâ', 'error');
            }
        }
        
        // ‡πÅ‡∏™‡∏î‡∏á UI ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        function showConnectedUI() {
            document.getElementById('not-connected').classList.add('hidden');
            document.getElementById('connected').classList.remove('hidden');
            document.getElementById('sync-info').textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå';
            document.getElementById('sync-id-display').textContent = cloudSyncId;
        }
        
        async function manualSyncToCloud() {
            if (!isCloudSyncConnected) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡πà‡∏≠‡∏ô', 'warning');
                return;
            }
            
            try {
                showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå...', 'success');
                
                const success = await syncToCloud();
                
                if (success) {
                    showToast('‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
                } else {
                    throw new Error('Sync failed');
                }
            } catch (error) {
                console.error('Error syncing to cloud:', error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
            }
        }

        function updateConnectionStatus() {
            const syncStatus = document.getElementById('sync-status');
            const connectionIndicator = document.getElementById('connection-indicator');
            const cloudSyncBtn = document.getElementById('google-sync-btn');
            
            if (isCloudSyncConnected) {
                // Update header status
                syncStatus.innerHTML = `
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    <span class="text-xs text-green-600">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</span>
                `;
                cloudSyncBtn.textContent = '‚úÖ ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå';
                cloudSyncBtn.className = 'text-xs bg-green-500 text-white px-3 py-1 rounded-full cursor-default';
                
                // Update connection indicator
                connectionIndicator.innerHTML = `
                    <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                    <span class="text-sm text-green-600">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</span>
                `;
            } else {
                // Update header status
                syncStatus.innerHTML = `
                    <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                    <span class="text-xs text-gray-500">‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</span>
                `;
                cloudSyncBtn.textContent = 'üåê ‡πÄ‡∏õ‡∏¥‡∏î‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå';
                cloudSyncBtn.className = 'text-xs bg-blue-500 text-white px-3 py-1 rounded-full hover:bg-blue-600 transition-colors';
                
                // Update connection indicator
                connectionIndicator.innerHTML = `
                    <div class="w-3 h-3 bg-gray-400 rounded-full"></div>
                    <span class="text-sm text-gray-600">‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</span>
                `;
            }
        }

        // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
        async function joinWithSyncCode() {
            const inputCode = document.getElementById('sync-code-input').value.trim();
            
            if (!inputCode) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå', 'warning');
                return;
            }
            
            try {
                console.log('üîó ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå:', inputCode);
                showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå...', 'success');
                
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏´‡∏°‡πà
                cloudSyncId = inputCode;
                localStorage.setItem('cloudSyncId', cloudSyncId);
                console.log('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡∏á localStorage ‡πÅ‡∏•‡πâ‡∏ß');
                
                // ‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ô‡∏µ‡πâ
                console.log('üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå...');
                const cloudData = await getCloudData();
                
                if (cloudData && cloudData.syncId === cloudSyncId) {
                    console.log('‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô!');
                    
                    // ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡πÉ‡∏ä‡πâ
                    classes = cloudData.classes || [];
                    subjects = cloudData.subjects || [];
                    attendanceRecords = cloudData.attendanceRecords || [];
                    
                    console.log('üìä ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', {
                        classes: classes.length,
                        subjects: subjects.length,
                        records: attendanceRecords.length
                    });
                    
                    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage
                    localStorage.setItem('classes', JSON.stringify(classes));
                    localStorage.setItem('subjects', JSON.stringify(subjects));
                    localStorage.setItem('attendanceRecords', JSON.stringify(attendanceRecords));
                    localStorage.setItem('lastSync', cloudData.lastSync);
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI
                    updateSelects();
                    renderClasses();
                    renderSubjects();
                    renderCalendar();
                    
                    // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                    isCloudSyncConnected = true;
                    localStorage.setItem('isCloudSyncConnected', 'true');
                    
                    updateConnectionStatus();
                    showConnectedUI();
                    startAutoSync();
                    
                    showToast('‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÅ‡∏•‡πâ‡∏ß', 'success');
                    
                    // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™
                    document.getElementById('sync-code-input').value = '';
                } else {
                    console.log('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô');
                    console.log('üìÑ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:', cloudData);
                    
                    // ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                    cloudSyncId = null;
                    localStorage.removeItem('cloudSyncId');
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
                    showSyncErrorModal(inputCode);
                }
            } catch (error) {
                console.error('‚ùå Error joining with sync code:', error);
                cloudSyncId = null;
                localStorage.removeItem('cloudSyncId');
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠', 'error');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
        function copySyncCodeToClipboard(syncCode, button) {
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å...';
            button.disabled = true;
            
            // Try modern clipboard API first
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(syncCode).then(() => {
                    button.innerHTML = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
                    button.className = button.className.replace('bg-blue-500', 'bg-green-500').replace('hover:bg-blue-600', 'hover:bg-green-600');
                    showToast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = button.className.replace('bg-green-500', 'bg-blue-500').replace('hover:bg-green-600', 'hover:bg-blue-600');
                        button.disabled = false;
                    }, 3000);
                }).catch(() => {
                    fallbackCopySyncCode(syncCode, button, originalText);
                });
            } else {
                fallbackCopySyncCode(syncCode, button, originalText);
            }
        }
        
        function fallbackCopySyncCode(syncCode, button, originalText) {
            try {
                // Create temporary textarea
                const textArea = document.createElement('textarea');
                textArea.value = syncCode;
                textArea.style.position = 'fixed';
                textArea.style.left = '-9999px';
                textArea.style.top = '-9999px';
                textArea.style.opacity = '0';
                textArea.style.pointerEvents = 'none';
                textArea.setAttribute('readonly', '');
                
                document.body.appendChild(textArea);
                
                // Select and copy
                textArea.focus();
                textArea.select();
                textArea.setSelectionRange(0, 99999); // For mobile devices
                
                const successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (successful) {
                    button.innerHTML = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
                    button.className = button.className.replace('bg-blue-500', 'bg-green-500').replace('hover:bg-blue-600', 'hover:bg-green-600');
                    showToast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = button.className.replace('bg-green-500', 'bg-blue-500').replace('hover:bg-green-600', 'hover:bg-blue-600');
                        button.disabled = false;
                    }, 3000);
                } else {
                    throw new Error('Copy command failed');
                }
            } catch (err) {
                button.innerHTML = '‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ';
                button.className = button.className.replace('bg-blue-500', 'bg-red-500').replace('hover:bg-blue-600', 'hover:bg-red-600');
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á', 'error');
                
                // Select the sync code display for manual copying
                const syncDisplay = document.getElementById('sync-id-display');
                if (syncDisplay) {
                    // Create a temporary selection
                    const range = document.createRange();
                    range.selectNodeContents(syncDisplay);
                    const selection = window.getSelection();
                    selection.removeAllRanges();
                    selection.addRange(range);
                }
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.className = button.className.replace('bg-red-500', 'bg-blue-500').replace('hover:bg-red-600', 'hover:bg-blue-600');
                    button.disabled = false;
                }, 3000);
            }
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
        function showSyncErrorModal(inputCode) {
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.style.zIndex = '9999';
            modal.innerHTML = `
                <div class="modal-content w-full max-w-2xl p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-red-600">‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ô‡∏µ‡πâ</h3>
                        <button onclick="this.closest('.modal').remove()" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <h4 class="font-semibold text-red-800 mb-2">üîç ‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÉ‡∏™‡πà: <span class="font-mono">${inputCode}</span></h4>
                            <p class="text-red-700">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
                        </div>
                        
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <h4 class="font-semibold text-yellow-800 mb-3">üîß ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</h4>
                            <ol class="text-yellow-700 space-y-2 list-decimal list-inside">
                                <li><strong>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå:</strong> ‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
                                <li><strong>‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô:</strong> ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</li>
                                <li><strong>‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö:</strong> ‡∏•‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</li>
                                <li><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà:</strong> ‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏´‡∏°‡πà</li>
                            </ol>
                        </div>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="font-semibold text-blue-800 mb-2">üí° ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:</h4>
                            <div class="text-blue-700 text-sm space-y-1">
                                <p><strong>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà 1 (‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•):</strong> ‡∏Å‡∏î "üåê ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏´‡∏°‡πà" ‚Üí ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™</p>
                                <p><strong>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà 2:</strong> ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‚Üí ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå ‚Üí ‡∏Å‡∏î "üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠"</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end mt-6">
                        <button onclick="this.closest('.modal').remove()" 
                            class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                            ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.remove();
                }
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á toast ‡∏î‡πâ‡∏ß‡∏¢
            showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏ô‡∏µ‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥', 'error');
        }

        function disconnectCloudSync() {
            showConfirmModal('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', () => {
                isCloudSyncConnected = false;
                cloudSyncId = null;
                
                localStorage.removeItem('cloudSyncId');
                localStorage.removeItem('isCloudSyncConnected');
                localStorage.removeItem('autoSyncEnabled');
                localStorage.removeItem('lastSync');
                
                // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                stopAutoSync();
                
                // Reset UI
                document.getElementById('not-connected').classList.remove('hidden');
                document.getElementById('connected').classList.add('hidden');
                document.getElementById('auto-sync').checked = false;
                document.getElementById('sync-code-input').value = '';
                
                updateConnectionStatus();
                showToast('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ', 'success');
            });
        }

        function viewCloudData() {
            if (!isCloudSyncConnected) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡πà‡∏≠‡∏ô', 'warning');
                return;
            }
            
            // Show cloud sync info
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.style.zIndex = '9999';
            modal.innerHTML = `
                <div class="modal-content w-full max-w-2xl p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-gray-800">üåê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h3>
                        <button onclick="this.closest('.modal').remove()" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="font-semibold text-green-800 mb-2">‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h4>
                            <p class="text-green-700">‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</p>
                        </div>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="font-semibold text-blue-800 mb-2">üîë ‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå</h4>
                            <p class="text-blue-700 font-mono text-sm break-all">${cloudSyncId}</p>
                            <p class="text-blue-600 text-sm mt-2">‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô</p>
                        </div>
                        
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <h4 class="font-semibold text-yellow-800 mb-2">üì± ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h4>
                            <ol class="text-yellow-700 text-sm space-y-1 list-decimal list-inside">
                                <li>‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏∑‡πà‡∏ô</li>
                                <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "üåê ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå"</li>
                                <li>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏õ‡∏¥‡∏î‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå"</li>
                                <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
                            </ol>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div class="bg-gray-50 rounded-lg p-3">
                                <div class="text-2xl font-bold text-gray-800">${classes.length}</div>
                                <div class="text-sm text-gray-600">‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-3">
                                <div class="text-2xl font-bold text-gray-800">${subjects.length}</div>
                                <div class="text-sm text-gray-600">‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-3">
                                <div class="text-2xl font-bold text-gray-800">${attendanceRecords.length}</div>
                                <div class="text-sm text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end mt-6">
                        <button onclick="this.closest('.modal').remove()" 
                            class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                            ‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.remove();
                }
            });
        }

        // Toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            
            if (type === 'success') {
                toast.className = 'toast bg-green-500 show';
            } else if (type === 'error') {
                toast.className = 'toast bg-red-500 show';
            } else if (type === 'warning') {
                toast.className = 'toast bg-yellow-500 show';
            }
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Initialize current date display
        function updateCurrentDate() {
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('current-date').textContent = 
                currentDate.toLocaleDateString('th-TH', options);
        }

        // Tab Navigation
        function initTabs() {
            const tabs = ['attendance', 'manage', 'history', 'sync'];
            
            tabs.forEach(tab => {
                document.getElementById(`tab-${tab}`).addEventListener('click', () => {
                    // Update tab buttons
                    tabs.forEach(t => {
                        const tabBtn = document.getElementById(`tab-${t}`);
                        const content = document.getElementById(`content-${t}`);
                        
                        if (t === tab) {
                            tabBtn.className = 'py-4 px-1 border-b-2 border-indigo-500 text-indigo-600 font-medium';
                            content.classList.remove('hidden');
                        } else {
                            tabBtn.className = 'py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium';
                            content.classList.add('hidden');
                        }
                    });
                    
                    // Load tab-specific data
                    if (tab === 'history') {
                        loadHistoryData();
                    } else if (tab === 'sync') {
                        updateConnectionStatus();
                    }
                });
            });
        }

        // Calendar Functions
        function renderCalendar() {
            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            const monthNames = [
                '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
            ];
            
            document.getElementById('calendar-month').textContent = 
                `${monthNames[currentMonth]} ${currentYear + 543}`;
            
            const calendarDays = document.getElementById('calendar-days');
            calendarDays.innerHTML = '';
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                calendarDays.appendChild(emptyDay);
            }
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                const date = new Date(currentYear, currentMonth, day);
                date.setHours(0, 0, 0, 0);
                
                const isFuture = date > today;
                const isSelected = date.getTime() === selectedDate.getTime();
                const isToday = date.getTime() === today.getTime();
                const hasRecords = checkDateHasRecords(date);
                
                let className = 'calendar-day';
                
                if (isFuture) {
                    className += ' future';
                } else if (isSelected) {
                    className += ' selected';
                } else if (isToday) {
                    className += ' today';
                } else if (hasRecords) {
                    className += ' has-records';
                }
                
                dayElement.className = className;
                dayElement.textContent = day;
                
                if (!isFuture) {
                    dayElement.addEventListener('click', () => {
                        selectedDate = new Date(currentYear, currentMonth, day);
                        renderCalendar();
                        updateSelectedDateDisplay();
                        loadStudentList();
                    });
                }
                
                calendarDays.appendChild(dayElement);
            }
        }

        function checkDateHasRecords(date) {
            const dateString = date.toISOString().split('T')[0];
            return attendanceRecords.some(record => record.date === dateString);
        }

        function updateSelectedDateDisplay() {
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('selected-date').textContent = 
                selectedDate.toLocaleDateString('th-TH', options);
        }

        function previousMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        }

        function nextMonth() {
            const today = new Date();
            const nextMonthDate = new Date(currentYear, currentMonth + 1, 1);
            
            if (nextMonthDate <= today) {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderCalendar();
            }
        }

        // Update select options
        function updateSelects() {
            const classSelect = document.getElementById('class-select');
            const subjectSelect = document.getElementById('subject-select');
            const filterClass = document.getElementById('filter-class');
            const filterSubject = document.getElementById('filter-subject');
            
            // Clear existing options
            [classSelect, filterClass].forEach(select => {
                const firstOption = select.firstElementChild;
                select.innerHTML = '';
                select.appendChild(firstOption);
            });
            
            [subjectSelect, filterSubject].forEach(select => {
                const firstOption = select.firstElementChild;
                select.innerHTML = '';
                select.appendChild(firstOption);
            });
            
            // Add class options
            classes.forEach(cls => {
                [classSelect, filterClass].forEach(select => {
                    const option = document.createElement('option');
                    option.value = cls.id;
                    option.textContent = cls.code;
                    select.appendChild(option);
                });
            });
            
            // Add subject options
            subjects.forEach(subject => {
                [subjectSelect, filterSubject].forEach(select => {
                    const option = document.createElement('option');
                    option.value = subject.id;
                    option.textContent = subject.name;
                    select.appendChild(option);
                });
            });
        }

        // Load student list for attendance
        function loadStudentList() {
            const classId = parseInt(document.getElementById('class-select').value);
            const subjectId = parseInt(document.getElementById('subject-select').value);
            const container = document.getElementById('student-list-container');
            const saveBtn = document.getElementById('save-attendance');
            
            if (!classId || !subjectId) {
                container.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                        </svg>
                        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤</p>
                    </div>
                `;
                saveBtn.disabled = true;
                return;
            }
            
            const selectedClass = classes.find(c => c.id === classId);
            if (!selectedClass || !selectedClass.students.length) {
                container.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ</p>
                    </div>
                `;
                saveBtn.disabled = true;
                return;
            }
            
            // Check for existing attendance record
            const dateString = selectedDate.toISOString().split('T')[0];
            const existingRecord = attendanceRecords.find(record => 
                record.date === dateString && 
                record.classId === classId && 
                record.subjectId === subjectId
            );
            
            container.innerHTML = `
                <div class="mb-4">
                    <h4 class="font-medium text-gray-800 mb-3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (${selectedClass.students.length} ‡∏Ñ‡∏ô)</h4>
                    <div class="space-y-2" id="student-attendance-list">
                        ${selectedClass.students.map(student => {
                            let currentStatus = '/';
                            if (existingRecord) {
                                const studentRecord = existingRecord.attendance.find(a => a.studentId === student.id);
                                if (studentRecord) currentStatus = studentRecord.status;
                            }
                            
                            return `
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <span class="text-sm font-medium text-gray-600 w-8">${student.number}</span>
                                        <span class="font-medium text-gray-800">${student.name}</span>
                                    </div>
                                    <div class="flex space-x-2">
                                        <button class="status-btn ${currentStatus === '/' ? 'bg-green-500 text-white active' : 'bg-green-100 text-green-800'}" 
                                            data-student-id="${student.id}" data-status="/">‚úì</button>
                                        <button class="status-btn ${currentStatus === '‡∏Ç' ? 'bg-red-500 text-white active' : 'bg-red-100 text-red-800'}" 
                                            data-student-id="${student.id}" data-status="‡∏Ç">‡∏Ç</button>
                                        <button class="status-btn ${currentStatus === '‡∏•' ? 'bg-orange-500 text-white active' : 'bg-orange-100 text-orange-800'}" 
                                            data-student-id="${student.id}" data-status="‡∏•">‡∏•</button>
                                        <button class="status-btn ${currentStatus === '‡∏õ' ? 'bg-blue-500 text-white active' : 'bg-blue-100 text-blue-800'}" 
                                            data-student-id="${student.id}" data-status="‡∏õ">‡∏õ</button>
                                        <button class="status-btn ${currentStatus === '‡∏™' ? 'bg-purple-500 text-white active' : 'bg-purple-100 text-purple-800'}" 
                                            data-student-id="${student.id}" data-status="‡∏™">‡∏™</button>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
            
            // Add event listeners to status buttons
            container.querySelectorAll('.status-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const studentId = parseInt(this.dataset.studentId);
                    const status = this.dataset.status;
                    
                    // Remove active class from all buttons for this student
                    const studentRow = this.closest('.flex');
                    studentRow.querySelectorAll('.status-btn').forEach(b => {
                        b.classList.remove('active', 'bg-green-500', 'bg-red-500', 'bg-orange-500', 'bg-blue-500', 'bg-purple-500', 'text-white');
                        const btnStatus = b.dataset.status;
                        if (btnStatus === '/') {
                            b.className = 'status-btn bg-green-100 text-green-800';
                        } else if (btnStatus === '‡∏Ç') {
                            b.className = 'status-btn bg-red-100 text-red-800';
                        } else if (btnStatus === '‡∏•') {
                            b.className = 'status-btn bg-orange-100 text-orange-800';
                        } else if (btnStatus === '‡∏õ') {
                            b.className = 'status-btn bg-blue-100 text-blue-800';
                        } else if (btnStatus === '‡∏™') {
                            b.className = 'status-btn bg-purple-100 text-purple-800';
                        }
                    });
                    
                    // Add active class to clicked button
                    this.classList.add('active', 'text-white');
                    if (status === '/') {
                        this.classList.add('bg-green-500');
                    } else if (status === '‡∏Ç') {
                        this.classList.add('bg-red-500');
                    } else if (status === '‡∏•') {
                        this.classList.add('bg-orange-500');
                    } else if (status === '‡∏õ') {
                        this.classList.add('bg-blue-500');
                    } else if (status === '‡∏™') {
                        this.classList.add('bg-purple-500');
                    }
                });
            });
            
            saveBtn.disabled = false;
        }

        // Save attendance
        function saveAttendance() {
            const classId = parseInt(document.getElementById('class-select').value);
            const subjectId = parseInt(document.getElementById('subject-select').value);
            const dateString = selectedDate.toISOString().split('T')[0];
            
            if (!classId || !subjectId) return;
            
            const selectedClass = classes.find(c => c.id === classId);
            const selectedSubject = subjects.find(s => s.id === subjectId);
            
            const attendance = [];
            selectedClass.students.forEach(student => {
                const activeBtn = document.querySelector(`[data-student-id="${student.id}"].active`);
                const status = activeBtn ? activeBtn.dataset.status : '/';
                
                attendance.push({
                    studentId: student.id,
                    studentName: student.name,
                    studentNumber: student.number,
                    status: status
                });
            });
            
            // Check if record already exists
            const existingIndex = attendanceRecords.findIndex(record => 
                record.date === dateString && 
                record.classId === classId && 
                record.subjectId === subjectId
            );
            
            if (existingIndex !== -1) {
                // Update existing record
                attendanceRecords[existingIndex].attendance = attendance;
                showToast('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            } else {
                // Create new record
                const newRecord = {
                    id: Date.now(),
                    date: dateString,
                    classId: classId,
                    className: selectedClass.code,
                    subjectId: subjectId,
                    subjectName: selectedSubject.name,
                    attendance: attendance
                };
                
                attendanceRecords.push(newRecord);
                showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            }
            
            saveData();
            renderCalendar(); // Update calendar to show records
        }

        // Cancel attendance
        function cancelAttendance() {
            document.getElementById('class-select').value = '';
            document.getElementById('subject-select').value = '';
            document.getElementById('student-list-container').innerHTML = `
                <div class="text-center py-12 text-gray-500">
                    <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                    </svg>
                    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤</p>
                </div>
            `;
            document.getElementById('save-attendance').disabled = true;
        }

        // Classes Management
        function renderClasses() {
            const container = document.getElementById('classes-list');
            
            if (classes.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>';
                return;
            }
            
            // Sort classes alphabetically
            const sortedClasses = [...classes].sort((a, b) => a.code.localeCompare(b.code, 'th'));
            
            container.innerHTML = sortedClasses.map(cls => `
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div>
                        <h4 class="font-medium text-gray-800">${cls.code}</h4>
                        <p class="text-sm text-gray-600">${cls.students.length} ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editClass(${cls.id})" class="p-2 text-indigo-600 hover:bg-indigo-50 rounded">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </button>
                        <button onclick="deleteClass(${cls.id})" class="p-2 text-red-600 hover:bg-red-50 rounded">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showClassModal(isEdit = false) {
            const modal = document.getElementById('class-modal');
            const title = document.getElementById('class-modal-title');
            
            title.textContent = isEdit ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà';
            modal.classList.add('show');
        }

        function hideClassModal() {
            document.getElementById('class-modal').classList.remove('show');
            document.getElementById('class-form').reset();
            document.getElementById('class-id').value = '';
            editingClass = null;
            renderStudentsInModal([]);
        }

        function editClass(id) {
            editingClass = classes.find(c => c.id === id);
            if (editingClass) {
                document.getElementById('class-id').value = editingClass.id;
                document.getElementById('class-code').value = editingClass.code;
                renderStudentsInModal(editingClass.students);
                showClassModal(true);
            }
        }

        function deleteClass(id) {
            const cls = classes.find(c => c.id === id);
            if (cls) {
                showConfirmModal(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô "${cls.code}" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`, () => {
                    classes = classes.filter(c => c.id !== id);
                    saveData();
                    renderClasses();
                    updateSelects();
                    showToast(`‡∏•‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${cls.code} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
                });
            }
        }

        function renderStudentsInModal(students = []) {
            const container = document.getElementById('students-container');
            
            if (students.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>';
                return;
            }
            
            container.innerHTML = students.map((student, index) => `
                <div class="flex items-center space-x-2 p-2 bg-white rounded border">
                    <input type="text" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà" value="${student.number}" 
                        class="w-16 px-2 py-1 border border-gray-300 rounded text-sm" 
                        name="student-number-${index}">
                    <input type="text" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" value="${student.studentId || ''}" 
                        class="w-24 px-2 py-1 border border-gray-300 rounded text-sm" 
                        name="student-id-${index}">
                    <input type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" value="${student.name}" 
                        class="flex-1 px-2 py-1 border border-gray-300 rounded text-sm" 
                        name="student-name-${index}">
                    <button type="button" onclick="removeStudent(${index})" class="p-1 text-red-500 hover:bg-red-50 rounded">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `).join('');
        }

        function addStudent() {
            const container = document.getElementById('students-container');
            const currentStudents = Array.from(container.querySelectorAll('.flex')).map((row, index) => ({
                number: row.querySelector(`[name="student-number-${index}"]`)?.value || '',
                studentId: row.querySelector(`[name="student-id-${index}"]`)?.value || '',
                name: row.querySelector(`[name="student-name-${index}"]`)?.value || ''
            }));
            
            currentStudents.push({ number: '', studentId: '', name: '' });
            renderStudentsInModal(currentStudents);
        }

        function removeStudent(index) {
            const container = document.getElementById('students-container');
            const rows = container.querySelectorAll('.flex');
            if (rows[index]) {
                rows[index].remove();
            }
        }

        function saveClass(e) {
            e.preventDefault();
            
            const code = document.getElementById('class-code').value.trim();
            if (!code) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', 'error');
                return;
            }
            
            const container = document.getElementById('students-container');
            const students = Array.from(container.querySelectorAll('.flex')).map((row, index) => ({
                id: index + 1,
                number: row.querySelector(`[name="student-number-${index}"]`)?.value || '',
                studentId: row.querySelector(`[name="student-id-${index}"]`)?.value || '',
                name: row.querySelector(`[name="student-name-${index}"]`)?.value || ''
            })).filter(student => student.name.trim() !== '');
            
            // Sort students by number
            students.sort((a, b) => {
                const numA = parseInt(a.number) || 999;
                const numB = parseInt(b.number) || 999;
                return numA - numB;
            });
            
            const classId = document.getElementById('class-id').value;
            
            if (classId) {
                // Edit existing class
                const index = classes.findIndex(c => c.id === parseInt(classId));
                if (index !== -1) {
                    classes[index] = { ...classes[index], code, students };
                    showToast(`‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${code} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
                }
            } else {
                // Add new class
                const newId = classes.length > 0 ? Math.max(...classes.map(c => c.id)) + 1 : 1;
                classes.push({ id: newId, code, students });
                showToast(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${code} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
            }
            
            saveData();
            renderClasses();
            updateSelects();
            hideClassModal();
        }

        // Excel Import
        function importExcel() {
            document.getElementById('excel-file').click();
        }

        function handleExcelFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å
            const fileName = file.name.toLowerCase();
            const validExtensions = ['.xlsx', '.xls'];
            const isValidFile = validExtensions.some(ext => fileName.endsWith(ext));
            
            if (!isValidFile) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel (.xlsx ‡∏´‡∏£‡∏∑‡∏≠ .xls) ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', 'error');
                event.target.value = '';
                return;
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà 10MB)
            const maxSize = 10 * 1024 * 1024; // 10MB
            if (file.size > maxSize) {
                showToast('‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà 10MB)', 'error');
                event.target.value = '';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    if (!workbook.SheetNames || workbook.SheetNames.length === 0) {
                        showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel', 'error');
                        return;
                    }
                    
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    if (!jsonData || jsonData.length === 0) {
                        showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel', 'error');
                        return;
                    }
                    
                    const students = [];
                    let startRow = 0;
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    if (jsonData.length > 0 && jsonData[0].some(cell => 
                        typeof cell === 'string' && 
                        (cell.includes('‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà') || cell.includes('‡∏ä‡∏∑‡πà‡∏≠') || cell.includes('‡∏£‡∏´‡∏±‡∏™') || 
                         cell.includes('number') || cell.includes('name') || cell.includes('id'))
                    )) {
                        startRow = 1;
                    }
                    
                    // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                    for (let i = startRow; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        if (row && row.length >= 1) {
                            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢
                            const name = String(row[2] || row[1] || row[0] || '').trim();
                            if (name) {
                                students.push({
                                    id: students.length + 1,
                                    number: String(row[0] || '').trim(),
                                    studentId: String(row[1] || '').trim(),
                                    name: name
                                });
                            }
                        }
                    }
                    
                    if (students.length > 0) {
                        renderStudentsInModal(students);
                        showToast(`‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${students.length} ‡∏Ñ‡∏ô`);
                    } else {
                        showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
                    }
                } catch (error) {
                    console.error('Excel import error:', error);
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå', 'error');
                }
            };
            
            reader.onerror = function() {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå', 'error');
            };
            
            reader.readAsArrayBuffer(file);
            event.target.value = '';
        }

        // Subjects Management
        function renderSubjects() {
            const container = document.getElementById('subjects-list');
            
            if (subjects.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>';
                return;
            }
            
            // Sort subjects alphabetically
            const sortedSubjects = [...subjects].sort((a, b) => a.name.localeCompare(b.name, 'th'));
            
            container.innerHTML = sortedSubjects.map(subject => `
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <h4 class="font-medium text-gray-800">${subject.name}</h4>
                    <div class="flex space-x-2">
                        <button onclick="editSubject(${subject.id})" class="p-2 text-indigo-600 hover:bg-indigo-50 rounded">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </button>
                        <button onclick="deleteSubject(${subject.id})" class="p-2 text-red-600 hover:bg-red-50 rounded">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showSubjectModal(isEdit = false) {
            const modal = document.getElementById('subject-modal');
            const title = document.getElementById('subject-modal-title');
            
            title.textContent = isEdit ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà';
            modal.classList.add('show');
        }

        function hideSubjectModal() {
            document.getElementById('subject-modal').classList.remove('show');
            document.getElementById('subject-form').reset();
            document.getElementById('subject-id').value = '';
            editingSubject = null;
        }

        function editSubject(id) {
            editingSubject = subjects.find(s => s.id === id);
            if (editingSubject) {
                document.getElementById('subject-id').value = editingSubject.id;
                document.getElementById('subject-name').value = editingSubject.name;
                showSubjectModal(true);
            }
        }

        function deleteSubject(id) {
            const subject = subjects.find(s => s.id === id);
            if (subject) {
                showConfirmModal(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤ "${subject.name}" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`, () => {
                    subjects = subjects.filter(s => s.id !== id);
                    saveData();
                    renderSubjects();
                    updateSelects();
                    showToast(`‡∏•‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤ ${subject.name} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
                });
            }
        }

        function saveSubject(e) {
            e.preventDefault();
            
            const name = document.getElementById('subject-name').value.trim();
            if (!name) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤', 'error');
                return;
            }
            
            const subjectId = document.getElementById('subject-id').value;
            
            if (subjectId) {
                // Edit existing subject
                const index = subjects.findIndex(s => s.id === parseInt(subjectId));
                if (index !== -1) {
                    subjects[index] = { ...subjects[index], name };
                    showToast(`‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏ä‡∏≤ ${name} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
                }
            } else {
                // Add new subject
                const newId = subjects.length > 0 ? Math.max(...subjects.map(s => s.id)) + 1 : 1;
                subjects.push({ id: newId, name });
                showToast(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤ ${name} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`);
            }
            
            // Sort subjects alphabetically
            subjects.sort((a, b) => a.name.localeCompare(b.name, 'th'));
            
            saveData();
            renderSubjects();
            updateSelects();
            hideSubjectModal();
        }

        // Confirm Modal
        function showConfirmModal(message, onConfirm) {
            document.getElementById('confirm-message').textContent = message;
            document.getElementById('confirm-modal').classList.add('show');
            
            document.getElementById('confirm-delete').onclick = () => {
                onConfirm();
                hideConfirmModal();
            };
        }

        function hideConfirmModal() {
            document.getElementById('confirm-modal').classList.remove('show');
        }

        // History Calendar Functions
        function renderHistoryCalendar() {
            const firstDay = new Date(historyCurrentYear, historyCurrentMonth, 1);
            const lastDay = new Date(historyCurrentYear, historyCurrentMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            const monthNames = [
                '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
            ];
            
            document.getElementById('history-calendar-month').textContent = 
                `${monthNames[historyCurrentMonth]} ${historyCurrentYear + 543}`;
            
            const calendarDays = document.getElementById('history-calendar-days');
            calendarDays.innerHTML = '';
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'w-8 h-8';
                calendarDays.appendChild(emptyDay);
            }
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                const date = new Date(historyCurrentYear, historyCurrentMonth, day);
                date.setHours(0, 0, 0, 0);
                
                const isFuture = date > today;
                const hasRecords = checkDateHasRecords(date);
                const isInRange = isDateInSelectedRange(date);
                const isRangeStart = selectedStartDate && date.getTime() === selectedStartDate.getTime();
                const isRangeEnd = selectedEndDate && date.getTime() === selectedEndDate.getTime();
                
                let className = 'w-8 h-8 flex items-center justify-center text-sm font-bold rounded cursor-pointer transition-all';
                
                if (isFuture) {
                    className += ' text-gray-300 cursor-not-allowed';
                } else if (isRangeStart || isRangeEnd) {
                    className += ' bg-indigo-600 text-white font-semibold';
                } else if (isInRange) {
                    className += ' bg-indigo-100 text-indigo-800';
                } else if (hasRecords) {
                    className += ' bg-green-100 text-green-800 hover:bg-green-200';
                } else {
                    className += ' text-gray-600 hover:bg-gray-100';
                }
                
                dayElement.className = className;
                dayElement.textContent = day;
                
                if (!isFuture) {
                    dayElement.addEventListener('click', () => {
                        selectHistoryDate(new Date(historyCurrentYear, historyCurrentMonth, day));
                    });
                }
                
                calendarDays.appendChild(dayElement);
            }
        }

        function selectHistoryDate(date) {
            if (!selectedStartDate || (selectedStartDate && selectedEndDate)) {
                // Start new selection
                selectedStartDate = new Date(date);
                selectedEndDate = null;
                isSelectingRange = true;
            } else if (selectedStartDate && !selectedEndDate) {
                // Complete range selection
                if (date < selectedStartDate) {
                    selectedEndDate = selectedStartDate;
                    selectedStartDate = new Date(date);
                } else {
                    selectedEndDate = new Date(date);
                }
                isSelectingRange = false;
            }
            
            // Reset filters when date is selected
            document.getElementById('filter-class').value = '';
            document.getElementById('filter-subject').value = '';
            
            updateSelectedDateRangeDisplay();
            renderHistoryCalendar();
            applyHistoryFilter();
        }

        function isDateInSelectedRange(date) {
            if (!selectedStartDate) return false;
            if (!selectedEndDate) return date.getTime() === selectedStartDate.getTime();
            
            return date >= selectedStartDate && date <= selectedEndDate;
        }

        function updateSelectedDateRangeDisplay() {
            const display = document.getElementById('selected-date-range');
            
            if (!selectedStartDate) {
                display.textContent = '‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà';
                return;
            }
            
            const options = { day: 'numeric', month: 'short', year: 'numeric' };
            
            if (!selectedEndDate) {
                display.textContent = selectedStartDate.toLocaleDateString('th-TH', options);
            } else if (selectedStartDate.getTime() === selectedEndDate.getTime()) {
                display.textContent = selectedStartDate.toLocaleDateString('th-TH', options);
            } else {
                display.textContent = `${selectedStartDate.toLocaleDateString('th-TH', options)} - ${selectedEndDate.toLocaleDateString('th-TH', options)}`;
            }
        }

        function historyPreviousMonth() {
            historyCurrentMonth--;
            if (historyCurrentMonth < 0) {
                historyCurrentMonth = 11;
                historyCurrentYear--;
            }
            renderHistoryCalendar();
        }

        function historyNextMonth() {
            const today = new Date();
            const nextMonthDate = new Date(historyCurrentYear, historyCurrentMonth + 1, 1);
            
            if (nextMonthDate <= today) {
                historyCurrentMonth++;
                if (historyCurrentMonth > 11) {
                    historyCurrentMonth = 0;
                    historyCurrentYear++;
                }
                renderHistoryCalendar();
            }
        }

        function setQuickDateFilter(type) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            switch (type) {
                case 'today':
                    selectedStartDate = new Date(today);
                    selectedEndDate = new Date(today);
                    break;
                    
                case 'week':
                    const startOfWeek = new Date(today);
                    startOfWeek.setDate(today.getDate() - today.getDay());
                    const endOfWeek = new Date(startOfWeek);
                    endOfWeek.setDate(startOfWeek.getDate() + 6);
                    
                    selectedStartDate = startOfWeek;
                    selectedEndDate = endOfWeek;
                    break;
                    
                case 'month':
                    selectedStartDate = new Date(today.getFullYear(), today.getMonth(), 1);
                    selectedEndDate = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                    break;
                    
                case 'all':
                    selectedStartDate = null;
                    selectedEndDate = null;
                    break;
            }
            
            updateSelectedDateRangeDisplay();
            renderHistoryCalendar();
            applyHistoryFilter();
        }

        // History Functions
        function loadHistoryData() {
            renderHistoryCalendar();
            applyHistoryFilter();
        }

        function applyHistoryFilter() {
            const classId = document.getElementById('filter-class').value;
            const subjectId = document.getElementById('filter-subject').value;
            
            let filteredRecords = [...attendanceRecords];
            
            // Filter by date range
            if (selectedStartDate) {
                const startDateString = selectedStartDate.toISOString().split('T')[0];
                const endDateString = selectedEndDate ? selectedEndDate.toISOString().split('T')[0] : startDateString;
                
                filteredRecords = filteredRecords.filter(record => {
                    return record.date >= startDateString && record.date <= endDateString;
                });
            }
            
            // Filter by class
            if (classId) {
                filteredRecords = filteredRecords.filter(record => record.classId === parseInt(classId));
            }
            
            // Filter by subject
            if (subjectId) {
                filteredRecords = filteredRecords.filter(record => record.subjectId === parseInt(subjectId));
            }
            
            updateSummary(filteredRecords);
            renderHistoryList(filteredRecords);
        }

        function updateSummary(records) {
            let present = 0, absent = 0, leave = 0, sick = 0, late = 0;
            
            records.forEach(record => {
                record.attendance.forEach(student => {
                    switch (student.status) {
                        case '/': present++; break;
                        case '‡∏Ç': absent++; break;
                        case '‡∏•': leave++; break;
                        case '‡∏õ': sick++; break;
                        case '‡∏™': late++; break;
                    }
                });
            });
            
            document.getElementById('summary-present').textContent = present;
            document.getElementById('summary-absent').textContent = absent;
            document.getElementById('summary-leave').textContent = leave;
            document.getElementById('summary-sick').textContent = sick;
            document.getElementById('summary-late').textContent = late;
        }

        function renderHistoryList(records) {
            const container = document.getElementById('history-list');
            
            if (records.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                    </div>
                `;
                return;
            }
            
            // Sort records by date (newest first)
            records.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            container.innerHTML = records.map((record, index) => {
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                const recordDate = new Date(record.date + 'T00:00:00');
                const day = recordDate.getDate();
                const month = recordDate.getMonth() + 1;
                const year = recordDate.getFullYear();
                const date = `${day.toString().padStart(2, '0')}/${month.toString().padStart(2, '0')}/${(year + 543)}`;
                
                const summary = record.attendance.reduce((acc, student) => {
                    acc[student.status] = (acc[student.status] || 0) + 1;
                    return acc;
                }, {});
                
                // Group students by status
                const studentsByStatus = {
                    '/': record.attendance.filter(s => s.status === '/'),
                    '‡∏Ç': record.attendance.filter(s => s.status === '‡∏Ç'),
                    '‡∏•': record.attendance.filter(s => s.status === '‡∏•'),
                    '‡∏õ': record.attendance.filter(s => s.status === '‡∏õ'),
                    '‡∏™': record.attendance.filter(s => s.status === '‡∏™')
                };
                
                const statusLabels = {
                    '/': { label: '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', color: 'green', bgColor: 'bg-green-50', textColor: 'text-green-800' },
                    '‡∏Ç': { label: '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', color: 'red', bgColor: 'bg-red-50', textColor: 'text-red-800' },
                    '‡∏•': { label: '‡∏•‡∏≤', color: 'orange', bgColor: 'bg-orange-50', textColor: 'text-orange-800' },
                    '‡∏õ': { label: '‡∏õ‡πà‡∏ß‡∏¢', color: 'blue', bgColor: 'bg-blue-50', textColor: 'text-blue-800' },
                    '‡∏™': { label: '‡∏™‡∏≤‡∏¢', color: 'purple', bgColor: 'bg-purple-50', textColor: 'text-purple-800' }
                };
                
                return `
                    <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
                        <div class="p-4 bg-gray-50 border-b border-gray-200">
                            <div class="flex justify-between items-start mb-3">
                                <div>
                                    <h4 class="font-semibold text-gray-800 text-lg">${record.className} - ${record.subjectName}</h4>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <button onclick="toggleRecordDetails(${index})" class="text-indigo-600 hover:bg-indigo-50 p-2 rounded-lg transition-colors">
                                        <svg id="toggle-icon-${index}" class="w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                        </svg>
                                    </button>
                                    <button onclick="deleteRecord(${record.id})" class="text-red-500 hover:bg-red-50 p-2 rounded-lg transition-colors">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="flex flex-wrap gap-3 text-sm">
                                <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full font-medium">‚úì ‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ${summary['/'] || 0}</span>
                                <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full font-medium">‡∏Ç ‡∏Ç‡∏≤‡∏î: ${summary['‡∏Ç'] || 0}</span>
                                <span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full font-medium">‡∏• ‡∏•‡∏≤: ${summary['‡∏•'] || 0}</span>
                                <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full font-medium">‡∏õ ‡∏õ‡πà‡∏ß‡∏¢: ${summary['‡∏õ'] || 0}</span>
                                <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full font-medium">‡∏™ ‡∏™‡∏≤‡∏¢: ${summary['‡∏™'] || 0}</span>
                            </div>
                        </div>
                        
                        <div id="record-details-${index}" class="hidden p-4">
                            <div class="space-y-4">
                                ${Object.entries(statusLabels).map(([status, config]) => {
                                    const students = studentsByStatus[status];
                                    if (students.length === 0) return '';
                                    
                                    return `
                                        <div class="${config.bgColor} rounded-lg p-4">
                                            <h5 class="font-semibold ${config.textColor} mb-3 flex items-center">
                                                <span class="w-6 h-6 rounded-full bg-${config.color}-500 text-white text-xs flex items-center justify-center mr-2">
                                                    ${status === '/' ? '‚úì' : status}
                                                </span>
                                                ${config.label} (${students.length} ‡∏Ñ‡∏ô)
                                            </h5>
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
                                                ${students.map(student => `
                                                    <div class="bg-white rounded-lg p-3 shadow-sm">
                                                        <div class="flex items-center space-x-2">
                                                            <span class="text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded">${student.studentNumber}</span>
                                                            <span class="text-sm font-medium text-gray-800">${student.studentName}</span>
                                                        </div>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    `;
                                }).filter(html => html !== '').join('')}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function toggleRecordDetails(index) {
            const details = document.getElementById(`record-details-${index}`);
            const icon = document.getElementById(`toggle-icon-${index}`);
            
            if (details.classList.contains('hidden')) {
                details.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                details.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        function deleteRecord(id) {
            showConfirmModal('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?', () => {
                attendanceRecords = attendanceRecords.filter(record => record.id !== id);
                saveData();
                loadHistoryData();
                renderCalendar();
                showToast('‡∏•‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            });
        }

        function exportExcel() {
            const classId = document.getElementById('filter-class').value;
            const subjectId = document.getElementById('filter-subject').value;
            
            let filteredRecords = [...attendanceRecords];
            
            // Filter by date range
            if (selectedStartDate) {
                const startDateString = selectedStartDate.toISOString().split('T')[0];
                const endDateString = selectedEndDate ? selectedEndDate.toISOString().split('T')[0] : startDateString;
                
                filteredRecords = filteredRecords.filter(record => {
                    return record.date >= startDateString && record.date <= endDateString;
                });
            }
            
            if (classId) {
                filteredRecords = filteredRecords.filter(record => record.classId === parseInt(classId));
            }
            
            if (subjectId) {
                filteredRecords = filteredRecords.filter(record => record.subjectId === parseInt(subjectId));
            }
            
            if (filteredRecords.length === 0) {
                showToast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å', 'warning');
                return;
            }
            
            // Sort records by date
            filteredRecords.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // Detect mobile/tablet device (including iPad)
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                            (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1); // iPad detection
            
            if (isMobile) {
                // For mobile devices, show data in a modal for copying/sharing
                showExportModal(filteredRecords, 'csv');
            } else {
                // For desktop, try to download CSV file
                try {
                    downloadCSV(filteredRecords);
                } catch (error) {
                    // Fallback to modal if download fails
                    showExportModal(filteredRecords, 'csv');
                }
            }
        }
        
        function exportPDF() {
            const classId = document.getElementById('filter-class').value;
            const subjectId = document.getElementById('filter-subject').value;
            
            let filteredRecords = [...attendanceRecords];
            
            // Filter by date range
            if (selectedStartDate) {
                const startDateString = selectedStartDate.toISOString().split('T')[0];
                const endDateString = selectedEndDate ? selectedEndDate.toISOString().split('T')[0] : startDateString;
                
                filteredRecords = filteredRecords.filter(record => {
                    return record.date >= startDateString && record.date <= endDateString;
                });
            }
            
            if (classId) {
                filteredRecords = filteredRecords.filter(record => record.classId === parseInt(classId));
            }
            
            if (subjectId) {
                filteredRecords = filteredRecords.filter(record => record.subjectId === parseInt(subjectId));
            }
            
            if (filteredRecords.length === 0) {
                showToast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å', 'warning');
                return;
            }
            
            // Sort records by date
            filteredRecords.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // Show PDF export modal for all devices
            showExportModal(filteredRecords, 'pdf');
        }
        
        function downloadCSV(records) {
            // Create CSV content
            let csvContent = '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà,‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô,‡∏ß‡∏¥‡∏ä‡∏≤,‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\n';
            
            records.forEach(record => {
                const recordDate = new Date(record.date + 'T00:00:00');
                const day = recordDate.getDate();
                const month = recordDate.getMonth() + 1;
                const year = recordDate.getFullYear();
                const date = `${day.toString().padStart(2, '0')}/${month.toString().padStart(2, '0')}/${(year + 543)}`;
                
                record.attendance.forEach(student => {
                    csvContent += `"${date}","${record.className}","${record.subjectName}","${student.studentNumber}","${student.studentName}","${student.status}"\n`;
                });
            });
            
            // Create and download file
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showToast('‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
        }
        
        function showExportModal(records, type = 'csv') {
            // Create formatted text
            let textContent = '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô\n';
            textContent += '='.repeat(50) + '\n\n';
            
            // Add summary
            let totalPresent = 0, totalAbsent = 0, totalLeave = 0, totalSick = 0, totalLate = 0;
            
            records.forEach(record => {
                record.attendance.forEach(student => {
                    switch (student.status) {
                        case '/': totalPresent++; break;
                        case '‡∏Ç': totalAbsent++; break;
                        case '‡∏•': totalLeave++; break;
                        case '‡∏õ': totalSick++; break;
                        case '‡∏™': totalLate++; break;
                    }
                });
            });
            
            textContent += `‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏°:\n`;
            textContent += `‚úì ‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ${totalPresent} ‡∏Ñ‡∏ô\n`;
            textContent += `‡∏Ç ‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ${totalAbsent} ‡∏Ñ‡∏ô\n`;
            textContent += `‡∏• ‡∏•‡∏≤: ${totalLeave} ‡∏Ñ‡∏ô\n`;
            textContent += `‡∏õ ‡∏õ‡πà‡∏ß‡∏¢: ${totalSick} ‡∏Ñ‡∏ô\n`;
            textContent += `‡∏™ ‡∏™‡∏≤‡∏¢: ${totalLate} ‡∏Ñ‡∏ô\n\n`;
            textContent += '='.repeat(50) + '\n\n';
            
            records.forEach(record => {
                const recordDate = new Date(record.date + 'T00:00:00');
                const day = recordDate.getDate();
                const month = recordDate.getMonth() + 1;
                const year = recordDate.getFullYear();
                const date = `${day.toString().padStart(2, '0')}/${month.toString().padStart(2, '0')}/${(year + 543)}`;
                
                textContent += `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${date}\n`;
                textContent += `‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: ${record.className}\n`;
                textContent += `‡∏ß‡∏¥‡∏ä‡∏≤: ${record.subjectName}\n`;
                textContent += '-'.repeat(30) + '\n';
                
                // Group by status
                const statusGroups = {
                    '/': { label: '‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', students: [] },
                    '‡∏Ç': { label: '‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', students: [] },
                    '‡∏•': { label: '‡∏•‡∏≤', students: [] },
                    '‡∏õ': { label: '‡∏õ‡πà‡∏ß‡∏¢', students: [] },
                    '‡∏™': { label: '‡∏™‡∏≤‡∏¢', students: [] }
                };
                
                record.attendance.forEach(student => {
                    if (statusGroups[student.status]) {
                        statusGroups[student.status].students.push(student);
                    }
                });
                
                Object.entries(statusGroups).forEach(([status, group]) => {
                    if (group.students.length > 0) {
                        textContent += `${group.label} (${group.students.length} ‡∏Ñ‡∏ô):\n`;
                        group.students.forEach(student => {
                            textContent += `  ${student.studentNumber}. ${student.studentName}\n`;
                        });
                        textContent += '\n';
                    }
                });
                
                textContent += '='.repeat(50) + '\n\n';
            });
            
            // Create modal content based on type
            const modalTitle = type === 'pdf' ? 'üìÑ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF' : 'üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            const instructionText = type === 'pdf' ? 
                '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDF: ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏≥‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏´‡∏£‡∏∑‡∏≠ Google Docs/Word ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF' :
                '‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏´‡∏£‡∏∑‡∏≠ "‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ä‡∏£‡πå‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏≠‡∏õ‡∏ï‡πà‡∏≤‡∏á‡πÜ';
            
            // Show modal with text content
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.style.zIndex = '9999';
            modal.innerHTML = `
                <div class="modal-content w-full max-w-4xl p-4 sm:p-6 max-h-[95vh] overflow-y-auto mx-4">
                    <div class="flex justify-between items-center mb-4 sm:mb-6">
                        <h3 class="text-lg sm:text-xl font-semibold text-gray-800">${modalTitle}</h3>
                        <button onclick="this.closest('.modal').remove()" class="text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100">
                            <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="mb-4 sm:mb-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 mb-4">
                            <h4 class="font-semibold text-blue-800 mb-2">üì± ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:</h4>
                            <p class="text-sm text-blue-700">${instructionText}</p>
                            ${type === 'pdf' ? `
                                <div class="mt-2 text-sm text-blue-700">
                                    <strong>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÅ‡∏≠‡∏õ PDF:</strong> Google Docs, Microsoft Word, WPS Office, ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏≠‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
                                </div>
                            ` : ''}
                        </div>
                        
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</label>
                        <textarea readonly id="export-textarea" class="w-full h-64 sm:h-96 px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg font-mono text-xs sm:text-sm resize-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-gray-50" 
                            onclick="this.select(); this.setSelectionRange(0, 99999);">${textContent}</textarea>
                    </div>
                    
                    <div class="flex flex-col space-y-3 sm:flex-row sm:justify-end sm:space-y-0 sm:space-x-3">
                        <button onclick="copyToClipboard(document.getElementById('export-textarea').value, this)" 
                            class="w-full sm:w-auto px-4 sm:px-6 py-3 sm:py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium text-sm sm:text-base">
                            üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        ${type !== 'pdf' ? `
                            <button onclick="shareData(document.getElementById('export-textarea').value, this)" 
                                class="w-full sm:w-auto px-4 sm:px-6 py-3 sm:py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium text-sm sm:text-base">
                                üì§ ‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                        ` : `
                            <button onclick="openPDFApps()" 
                                class="w-full sm:w-auto px-4 sm:px-6 py-3 sm:py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium text-sm sm:text-base">
                                üìÑ ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ PDF
                            </button>
                        `}
                        <button onclick="this.closest('.modal').remove()" 
                            class="w-full sm:w-auto px-4 sm:px-6 py-3 sm:py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium text-sm sm:text-base">
                            ‡∏õ‡∏¥‡∏î
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.remove();
                }
            });
            
            // Auto-focus and select text
            setTimeout(() => {
                const textarea = document.getElementById('export-textarea');
                if (textarea) {
                    textarea.focus();
                    textarea.select();
                }
            }, 100);
        }
        
        function openPDFApps() {
            // Try to open Google Docs in a new tab
            const googleDocsUrl = 'https://docs.google.com/document/create';
            window.open(googleDocsUrl, '_blank');
            
            showToast('‡πÄ‡∏õ‡∏¥‡∏î Google Docs ‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô Google Docs ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà File > Download > PDF', 'success');
        }
        
        function copyToClipboard(text, button) {
            // Show loading state
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å...';
            button.disabled = true;
            
            // Try modern clipboard API first
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    button.innerHTML = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
                    button.className = button.className.replace('bg-green-500', 'bg-green-600');
                    showToast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ');
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = button.className.replace('bg-green-600', 'bg-green-500');
                        button.disabled = false;
                    }, 3000);
                }).catch(() => {
                    fallbackCopyToClipboard(text, button, originalText);
                });
            } else {
                fallbackCopyToClipboard(text, button, originalText);
            }
        }
        
        function fallbackCopyToClipboard(text, button, originalText) {
            try {
                // Create temporary textarea
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.left = '-9999px';
                textArea.style.top = '-9999px';
                textArea.style.opacity = '0';
                textArea.style.pointerEvents = 'none';
                textArea.setAttribute('readonly', '');
                
                document.body.appendChild(textArea);
                
                // Select and copy
                textArea.focus();
                textArea.select();
                textArea.setSelectionRange(0, 99999); // For mobile devices
                
                const successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (successful) {
                    button.innerHTML = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
                    button.className = button.className.replace('bg-green-500', 'bg-green-600');
                    showToast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ');
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = button.className.replace('bg-green-600', 'bg-green-500');
                        button.disabled = false;
                    }, 3000);
                } else {
                    throw new Error('Copy command failed');
                }
            } catch (err) {
                button.innerHTML = '‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ';
                button.className = button.className.replace('bg-green-500', 'bg-red-500');
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á', 'error');
                
                // Select the textarea for manual copying
                const textarea = document.getElementById('export-textarea');
                if (textarea) {
                    textarea.focus();
                    textarea.select();
                    textarea.setSelectionRange(0, 99999);
                }
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.className = button.className.replace('bg-red-500', 'bg-green-500');
                    button.disabled = false;
                }, 3000);
            }
        }
        
        function shareData(text, button) {
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏ä‡∏£‡πå...';
            button.disabled = true;
            
            // Check if Web Share API is supported
            if (navigator.share && navigator.canShare && navigator.canShare({ text: text })) {
                navigator.share({
                    title: '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                    text: text
                }).then(() => {
                    button.innerHTML = '‚úÖ ‡πÅ‡∏ä‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß!';
                    button.className = button.className.replace('bg-blue-500', 'bg-blue-600');
                    showToast('‡πÅ‡∏ä‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = button.className.replace('bg-blue-600', 'bg-blue-500');
                        button.disabled = false;
                    }, 2000);
                }).catch((error) => {
                    if (error.name !== 'AbortError') {
                        // Fallback to copy
                        button.innerHTML = 'üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏ó‡∏ô';
                        copyToClipboard(text, button);
                    } else {
                        button.innerHTML = originalText;
                        button.disabled = false;
                    }
                });
            } else {
                // Fallback to copy if share is not supported
                button.innerHTML = 'üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏ó‡∏ô';
                showToast('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡∏à‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ó‡∏ô', 'warning');
                setTimeout(() => {
                    copyToClipboard(text, button);
                }, 500);
            }
        }

        function clearHistory() {
            showConfirmModal('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?', () => {
                attendanceRecords = [];
                saveData();
                loadHistoryData();
                renderCalendar();
                showToast('‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            });
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize
            updateCurrentDate();
            updateSelectedDateDisplay();
            renderCalendar();
            updateSelects();
            renderClasses();
            renderSubjects();
            initTabs();
            
            // Initialize Cloud Sync connection status
            const savedSyncStatus = localStorage.getItem('isCloudSyncConnected');
            if (savedSyncStatus === 'true' && cloudSyncId) {
                isCloudSyncConnected = true;
                updateConnectionStatus();
                document.getElementById('not-connected').classList.add('hidden');
                document.getElementById('connected').classList.remove('hidden');
                document.getElementById('sync-info').textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå';
                document.getElementById('sync-id-display').textContent = cloudSyncId;
                
                // Try to load data from cloud on startup
                setTimeout(() => {
                    initializeCloudSync();
                }, 1000);
            }
            
            // Set auto-sync checkbox
            document.getElementById('auto-sync').checked = autoSyncEnabled;
            
            // Calendar navigation
            document.getElementById('prev-month').addEventListener('click', previousMonth);
            document.getElementById('next-month').addEventListener('click', nextMonth);
            
            // Attendance form
            document.getElementById('class-select').addEventListener('change', loadStudentList);
            document.getElementById('subject-select').addEventListener('change', loadStudentList);
            document.getElementById('save-attendance').addEventListener('click', saveAttendance);
            document.getElementById('cancel-attendance').addEventListener('click', cancelAttendance);
            
            // Status buttons
            document.querySelectorAll('.status-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    selectedStatus = this.dataset.status;
                    
                    // Update button styles
                    document.querySelectorAll('.status-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Class management
            document.getElementById('add-class').addEventListener('click', () => showClassModal());
            document.getElementById('close-class-modal').addEventListener('click', hideClassModal);
            document.getElementById('cancel-class').addEventListener('click', hideClassModal);
            document.getElementById('class-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveClass(e);
            });
            document.getElementById('add-student').addEventListener('click', addStudent);
            document.getElementById('import-excel').addEventListener('click', importExcel);
            document.getElementById('excel-file').addEventListener('change', handleExcelFile);
            
            // Subject management
            document.getElementById('add-subject').addEventListener('click', () => showSubjectModal());
            document.getElementById('close-subject-modal').addEventListener('click', hideSubjectModal);
            document.getElementById('cancel-subject').addEventListener('click', hideSubjectModal);
            document.getElementById('subject-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveSubject(e);
            });
            
            // Confirm modal
            document.getElementById('confirm-cancel').addEventListener('click', hideConfirmModal);
            
            // History
            document.getElementById('filter-class').addEventListener('change', applyHistoryFilter);
            document.getElementById('filter-subject').addEventListener('change', applyHistoryFilter);
            document.getElementById('export-excel').addEventListener('click', exportExcel);
            document.getElementById('export-pdf').addEventListener('click', exportPDF);
            document.getElementById('clear-history').addEventListener('click', clearHistory);
            
            // History Calendar
            document.getElementById('history-prev-month').addEventListener('click', historyPreviousMonth);
            document.getElementById('history-next-month').addEventListener('click', historyNextMonth);
            
            // Cloud Sync Integration
            document.getElementById('google-sync-btn').addEventListener('click', connectToCloudSync);
            document.getElementById('connect-google').addEventListener('click', connectToCloudSync);
            document.getElementById('join-sync').addEventListener('click', joinWithSyncCode);
            document.getElementById('sync-now').addEventListener('click', manualSyncToCloud);
            document.getElementById('view-sheet').addEventListener('click', viewCloudData);
            document.getElementById('disconnect-google').addEventListener('click', disconnectCloudSync);
            
            // Enter key ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå
            document.getElementById('sync-code-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    joinWithSyncCode();
                }
            });
            
            // Auto-sync toggle
            document.getElementById('auto-sync').addEventListener('change', function() {
                autoSyncEnabled = this.checked;
                localStorage.setItem('autoSyncEnabled', autoSyncEnabled.toString());
                showToast(autoSyncEnabled ? '‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß' : '‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß');
            });
            
            // Copy sync code button
            document.getElementById('copy-sync-code').addEventListener('click', function() {
                const syncCode = document.getElementById('sync-id-display').textContent;
                if (syncCode && syncCode !== '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™...') {
                    copySyncCodeToClipboard(syncCode, this);
                } else {
                    showToast('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å', 'warning');
                }
            });
            
            // Close modals when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('show');
                    }
                });
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96acb738d5087336',t:'MTc1NDQ2NDIzOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
